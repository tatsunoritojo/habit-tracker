# MVPä»•æ§˜æ›¸ï¼šç¿’æ…£ç¶™ç¶šÃ—è»½é‡SNSã‚¢ãƒ—ãƒª

## åŸºæœ¬æƒ…å ±

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¨®åˆ¥ | MVPä»•æ§˜æ›¸ |
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | 1.1 |
| ä½œæˆæ—¥ | 2025å¹´11æœˆ26æ—¥ |
| æœ€çµ‚æ›´æ–° | 2025å¹´12æœˆ8æ—¥ |
| ä½œæˆè€… | Claude Code |

---

## 1. MVPæ¦‚è¦

### 1.1 MVPã®ç›®çš„

- ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆã€Œç¹‹ãŒã‚Šã™ããªã„ç¹‹ãŒã‚Šã€ã®æ¤œè¨¼
- 1ã‚¿ãƒƒãƒ—è¨˜éŒ² + è»½é‡ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ã®çµ„ã¿åˆã‚ã›ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å—ã‘å…¥ã‚Œã‚‰ã‚Œã‚‹ã‹ç¢ºèª
- ã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰Î²ã§ä»²é–“å†…ã‹ã‚‰ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’åé›†

### 1.2 MVPã‚¹ã‚³ãƒ¼ãƒ—

| æ©Ÿèƒ½ | MVP | å°†æ¥ |
|------|-----|------|
| ã‚«ãƒ¼ãƒ‰ä½œæˆï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼‰ | âœ… | - |
| ã‚«ãƒ¼ãƒ‰ä½œæˆï¼ˆã‚ªãƒªã‚¸ãƒŠãƒ«ï¼‰ | âœ… | å…±æœ‰æ©Ÿèƒ½è¿½åŠ  |
| 1ã‚¿ãƒƒãƒ—è¨˜éŒ² | âœ… | - |
| ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æŒ¯ã‚Šè¿”ã‚Š | âœ… | ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—è¿½åŠ  |
| å…¬é–‹/éå…¬é–‹è¨­å®š | âœ… | - |
| ã‚«ãƒ†ã‚´ãƒªãƒ™ãƒ¼ã‚¹ãƒãƒƒãƒãƒ³ã‚° | âœ… | ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ç²¾ç·»åŒ– |
| AIã‚¨ãƒ¼ãƒ«é€å—ä¿¡ | âœ… | æ–‡è¨€è¿½åŠ  |
| äººé–“ã‚¨ãƒ¼ãƒ«é€å—ä¿¡ | âœ… | ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³è¿½åŠ  |
| åŒ¿åèªè¨¼ | âœ… | ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ˜‡æ ¼ |
| ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ | âœ… | - |
| ã‚¨ãƒ¼ãƒ«é »åº¦è¨­å®šï¼ˆæ‰‹å‹•ï¼‰ | âœ… | è‡ªå‹•èª¿æ•´ |
| ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼é€šçŸ¥ | âœ… | - |
| ãƒãƒƒã‚¸æ©Ÿèƒ½ | âœ… | ç¨®é¡è¿½åŠ  |
| ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ©Ÿèƒ½ | âœ… | - |
| ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚° | âœ… | - |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆã‚«ãƒ¼ãƒ‰å…±æœ‰ | âŒ | âœ… |
| æ²ç¤ºæ¿æ©Ÿèƒ½ | âŒ | æ¤œè¨ |

---

## 2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å‚™è€ƒ |
|----------|------|------------|------|
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | React Native + Expo | 54.0.25 | Androidå„ªå…ˆ |
| ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° | Expo Router | 6.0.15 | ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ |
| è¨€èª | TypeScript | 5.9.2 | |
| èªè¨¼ | Firebase Anonymous Auth | 12.6.0 | åŒ¿åèªè¨¼ |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | Cloud Firestore | 12.6.0 | NoSQLã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸ |
| ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚¸ãƒƒã‚¯ | Cloud Functions | - | ãƒãƒƒãƒãƒ³ã‚°ã€ã‚¨ãƒ¼ãƒ«é€ä¿¡ç­‰ |
| ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ | Firebase Cloud Messaging | - | |
| ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ | AsyncStorage | 2.2.0 | èªè¨¼çŠ¶æ…‹æ°¸ç¶šåŒ– |

---

## 3. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«

### 3.1 ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ä¸€è¦§

| ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ | èª¬æ˜ | è¿½åŠ Phase |
|--------------|------|-----------|
| users | ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ± | - |
| cards | ç¿’æ…£ã‚«ãƒ¼ãƒ‰ | - |
| logs | é”æˆãƒ­ã‚° | - |
| categories | ã‚«ãƒ†ã‚´ãƒªãƒã‚¹ã‚¿ | - |
| card_templates | ã‚«ãƒ¼ãƒ‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ | - |
| matching_pools | ãƒãƒƒãƒãƒ³ã‚°ãƒ—ãƒ¼ãƒ« | Phase 8 |
| reactions | ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆã‚¨ãƒ¼ãƒ«ï¼‰ | Phase 7ã§æ‹¡å¼µ |
| cheer_state | AIã‚¨ãƒ¼ãƒ«çŠ¶æ…‹ç®¡ç† | Phase 7 |
| cheer_send_state | äººé–“ã‚¨ãƒ¼ãƒ«é€ä¿¡åˆ¶é™ | Phase 8 |
| favorites | ãŠæ°—ã«å…¥ã‚Š | Phase 10-A |

### 3.2 users

```typescript
users/{uid}
{
  uid: string;                      // Firebase Auth UID
  display_name?: string;            // Phase 9.5: ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ 
  created_at: Timestamp;
  last_login_at: Timestamp;
  
  settings: {
    cheer_frequency: 'high' | 'medium' | 'low' | 'off';
    push_enabled: boolean;
    timezone: string;               // "Asia/Tokyo"
    
    // Phase 7: ã‚¨ãƒ¼ãƒ«é€šçŸ¥è¨­å®š
    notification_mode: 'realtime' | 'batch';
    batch_times: string[];          // ["12:00", "18:00", "22:00"]
    quiet_hours_enabled: boolean;   // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: true
    quiet_hours_start: string;      // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: "23:00"
    quiet_hours_end: string;        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: "07:00"
    
    fcm_token?: string | null;
  };
  
  stats: {
    total_cards: number;
    total_logs: number;
    current_streak_max: number;
    cheers_received: number;        // æœªå®Ÿè£…ï¼ˆPhase 10ä»¥é™ï¼‰
    cheers_sent: number;            // æœªå®Ÿè£…ï¼ˆPhase 10ä»¥é™ï¼‰
  };
}
```

### 3.3 cards

```typescript
cards/{cardId}
{
  card_id: string;
  owner_uid: string;
  
  // ã‚«ãƒ†ã‚´ãƒªï¼ˆ3éšå±¤ï¼‰
  category_l1: string;              // ä¾‹: "health"
  category_l2: string;              // ä¾‹: "exercise"
  category_l3: string;              // ä¾‹: "muscle_training"
  
  // ã‚«ãƒ¼ãƒ‰æƒ…å ±
  title: string;
  template_id: string | null;       // ã‚ªãƒªã‚¸ãƒŠãƒ«ã®å ´åˆã¯null
  is_custom: boolean;               // ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚«ãƒ¼ãƒ‰åˆ¤å®š
  
  // å…¬é–‹è¨­å®š
  is_public: boolean;               // Phase 9.5: deprecated
  
  // Phase 9.5: å…¬é–‹è¨­å®šã®ç´°åˆ†åŒ–
  is_public_for_cheers?: boolean;   // ã‚¨ãƒ¼ãƒ«ã‚’å—ã‘å–ã‚‹
  is_public_for_template?: boolean; // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨ã—ã¦å…¬é–‹
  
  // çµ±è¨ˆï¼ˆéæ­£è¦åŒ–ï¼‰
  current_streak: number;
  longest_streak: number;
  total_logs: number;
  last_log_date: string;            // "YYYY-MM-DD"
  
  // Phase 9: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç®¡ç†
  status: 'active' | 'archived';
  archived_at?: Timestamp | null;
  
  // Phase 9: ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼è¨­å®š
  reminder_enabled?: boolean;
  reminder_time?: string | null;    // "HH:mm"
  
  created_at: Timestamp;
  updated_at: Timestamp;
}
```

### 3.4 logs

```typescript
logs/{logId}
{
  log_id: string;
  card_id: string;
  owner_uid: string;
  
  date: string;                     // "YYYY-MM-DD"
  logged_at: Timestamp;
}
```

### 3.5 categories

```typescript
categories/{categoryId}
{
  category_id: string;
  level: 1 | 2 | 3;
  parent_id: string | null;
  
  name_ja: string;
  name_en: string;
  icon: string;
  sort_order: number;
  is_active: boolean;
}
```

### 3.6 card_templates

```typescript
card_templates/{templateId}
{
  template_id: string;
  
  category_l1: string;
  category_l2: string;
  category_l3: string;
  
  title_ja: string;
  title_en: string;
  description_ja: string | null;
  
  icon: string;
  sort_order: number;
  is_official: boolean;             // MVP: å¸¸ã«true
  is_active: boolean;
  created_at: Timestamp;
}
```

### 3.7 matching_poolsï¼ˆPhase 8è¿½åŠ ï¼‰

```typescript
matching_pools/{categoryL3Id}
{
  category_l3: string;
  category_l3_name_ja: string;
  
  active_cards: MatchingPoolCard[];
  
  updated_at: Timestamp;
}

interface MatchingPoolCard {
  card_id: string;
  owner_uid: string;
  title?: string;
  current_streak: number;
  last_log_date: string;
  total_logs?: number;
  is_comeback?: boolean;            // ç›´è¿‘2ãƒ­ã‚°ã®å·®åˆ†â‰§4æ—¥
}
```

### 3.8 reactionsï¼ˆPhase 7/8ã§æ‹¡å¼µï¼‰

```typescript
reactions/{reactionId}
{
  reaction_id: string;
  
  from_uid: string;                 // "system" or ãƒ¦ãƒ¼ã‚¶ãƒ¼UID
  to_uid: string;
  to_card_id: string;
  
  type: 'cheer' | 'amazing' | 'support';
  
  // Phase 7: AIã‚¨ãƒ¼ãƒ«æ‹¡å¼µ
  reason?: 'record' | 'streak_break' | 'long_absence' | 'random';
  message?: string;                 // AIã‚¨ãƒ¼ãƒ«æ–‡è¨€
  scheduled_for?: Timestamp | null;
  delivered?: boolean;
  
  // Phase 9: éæ­£è¦åŒ–ï¼ˆé€šçŸ¥ç”»é¢ç”¨ï¼‰
  card_title?: string;
  card_category_name?: string;
  
  created_at: Timestamp;
  is_read: boolean;
}
```

### 3.9 cheer_stateï¼ˆPhase 7è¿½åŠ ï¼‰

```typescript
cheer_state/{user_uid}
{
  user_uid: string;
  
  daily_count: number;
  daily_count_date: string;         // "YYYY-MM-DD"
  
  weekly_streak_break_count: number;
  weekly_streak_break_reset_date: string;
  
  last_random_cheer_at: Timestamp | null;
  
  long_absence_cheers: {
    [card_id: string]: {
      count: number;                // æœ€å¤§3
      last_sent_at: Timestamp;
    };
  };
  
  primary_recording_hour: number | null;
  
  updated_at: Timestamp;
}
```

### 3.10 cheer_send_stateï¼ˆPhase 8è¿½åŠ ï¼‰

```typescript
cheer_send_state/{user_uid}
{
  user_uid: string;
  daily_send_count: number;
  daily_send_date: string;          // "YYYY-MM-DD"
  sent_pairs: SentPair[];
  updated_at: Timestamp;
}

interface SentPair {
  to_card_id: string;
  sent_at: Timestamp;
}
```

---

## 4. ã‚«ãƒ†ã‚´ãƒªæ§‹é€ ï¼ˆMVPåˆæœŸï¼‰

### 4.1 L1ã‚«ãƒ†ã‚´ãƒª

| ID | åç§°ï¼ˆæ—¥æœ¬èªï¼‰ | åç§°ï¼ˆè‹±èªï¼‰ | ã‚¢ã‚¤ã‚³ãƒ³ |
|----|----------------|--------------|----------|
| health | å¥åº· | Health | ğŸ’ª |
| learning | å­¦ç¿’ | Learning | ğŸ“š |
| lifestyle | ç”Ÿæ´»ç¿’æ…£ | Lifestyle | ğŸ  |
| creative | å‰µä½œ | Creative | ğŸ¨ |
| mindfulness | ãƒã‚¤ãƒ³ãƒ‰ãƒ•ãƒ«ãƒã‚¹ | Mindfulness | ğŸ§˜ |

### 4.2 ã‚«ãƒ†ã‚´ãƒªéšå±¤ä¾‹

```
healthï¼ˆå¥åº·ï¼‰
â”œâ”€â”€ exerciseï¼ˆé‹å‹•ï¼‰
â”‚   â”œâ”€â”€ muscle_trainingï¼ˆç­‹ãƒˆãƒ¬ï¼‰
â”‚   â”œâ”€â”€ runningï¼ˆãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ï¼‰
â”‚   â”œâ”€â”€ walkingï¼ˆã‚¦ã‚©ãƒ¼ã‚­ãƒ³ã‚°ï¼‰
â”‚   â”œâ”€â”€ stretchingï¼ˆã‚¹ãƒˆãƒ¬ãƒƒãƒï¼‰
â”‚   â””â”€â”€ yogaï¼ˆãƒ¨ã‚¬ï¼‰
â”œâ”€â”€ dietï¼ˆé£Ÿäº‹ï¼‰
â”‚   â”œâ”€â”€ healthy_eatingï¼ˆå¥åº·çš„ãªé£Ÿäº‹ï¼‰
â”‚   â””â”€â”€ water_intakeï¼ˆæ°´åˆ†æ‘‚å–ï¼‰
â””â”€â”€ sleepï¼ˆç¡çœ ï¼‰
    â”œâ”€â”€ early_sleepï¼ˆæ—©å¯ï¼‰
    â””â”€â”€ sleep_logï¼ˆç¡çœ è¨˜éŒ²ï¼‰

learningï¼ˆå­¦ç¿’ï¼‰
â”œâ”€â”€ languageï¼ˆèªå­¦ï¼‰
â”‚   â”œâ”€â”€ englishï¼ˆè‹±èªï¼‰
â”‚   â”œâ”€â”€ chineseï¼ˆä¸­å›½èªï¼‰
â”‚   â””â”€â”€ other_languageï¼ˆãã®ä»–ã®è¨€èªï¼‰
â”œâ”€â”€ readingï¼ˆèª­æ›¸ï¼‰
â”‚   â”œâ”€â”€ book_readingï¼ˆèª­æ›¸ï¼‰
â”‚   â””â”€â”€ article_readingï¼ˆè¨˜äº‹èª­ã¿ï¼‰
â””â”€â”€ skillï¼ˆã‚¹ã‚­ãƒ«ï¼‰
    â”œâ”€â”€ programmingï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ï¼‰
    â””â”€â”€ certificationï¼ˆè³‡æ ¼å‹‰å¼·ï¼‰

lifestyleï¼ˆç”Ÿæ´»ç¿’æ…£ï¼‰
â”œâ”€â”€ morningï¼ˆæœæ´»ï¼‰
â”‚   â”œâ”€â”€ early_wakeï¼ˆæ—©èµ·ãï¼‰
â”‚   â””â”€â”€ morning_routineï¼ˆæœã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ï¼‰
â”œâ”€â”€ organizationï¼ˆæ•´ç†æ•´é “ï¼‰
â”‚   â”œâ”€â”€ cleaningï¼ˆæƒé™¤ï¼‰
â”‚   â””â”€â”€ declutterï¼ˆæ–­æ¨é›¢ï¼‰
â””â”€â”€ financeï¼ˆãŠé‡‘ï¼‰
    â”œâ”€â”€ savingï¼ˆè²¯é‡‘ï¼‰
    â””â”€â”€ expense_logï¼ˆæ”¯å‡ºè¨˜éŒ²ï¼‰

creativeï¼ˆå‰µä½œï¼‰
â”œâ”€â”€ writingï¼ˆåŸ·ç­†ï¼‰
â”‚   â”œâ”€â”€ journalingï¼ˆæ—¥è¨˜ï¼‰
â”‚   â””â”€â”€ blog_writingï¼ˆãƒ–ãƒ­ã‚°ï¼‰
â”œâ”€â”€ artï¼ˆã‚¢ãƒ¼ãƒˆï¼‰
â”‚   â”œâ”€â”€ drawingï¼ˆçµµã‚’æãï¼‰
â”‚   â””â”€â”€ photographyï¼ˆå†™çœŸï¼‰
â””â”€â”€ musicï¼ˆéŸ³æ¥½ï¼‰
    â””â”€â”€ instrument_practiceï¼ˆæ¥½å™¨ç·´ç¿’ï¼‰

mindfulnessï¼ˆãƒã‚¤ãƒ³ãƒ‰ãƒ•ãƒ«ãƒã‚¹ï¼‰
â”œâ”€â”€ meditationï¼ˆç‘æƒ³ï¼‰
â”‚   â””â”€â”€ daily_meditationï¼ˆæ¯æ—¥ã®ç‘æƒ³ï¼‰
â”œâ”€â”€ gratitudeï¼ˆæ„Ÿè¬ï¼‰
â”‚   â””â”€â”€ gratitude_logï¼ˆæ„Ÿè¬æ—¥è¨˜ï¼‰
â””â”€â”€ mental_healthï¼ˆãƒ¡ãƒ³ã‚¿ãƒ«ãƒ˜ãƒ«ã‚¹ï¼‰
    â””â”€â”€ mood_logï¼ˆæ°—åˆ†è¨˜éŒ²ï¼‰
```

---

## 5. ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç¨®åˆ¥

### 5.1 æ¡ç”¨ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆ3ç¨®ï¼‰

| type | è¡¨ç¤ºå | ã‚¢ã‚¤ã‚³ãƒ³ | æ„å‘³ãƒ»ä½¿ã†å ´é¢ |
|------|--------|----------|----------------|
| cheer | ãƒŠã‚¤ã‚¹ç¶™ç¶š | ğŸ’ª | ç¶™ç¶šãã®ã‚‚ã®ã¸ã®åŠ±ã¾ã—ã€‚åŸºç¤ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€‚ |
| amazing | ã™ã”ã„ï¼ | â­ | ç¯€ç›®ãƒ»æˆé•·ã¸ã®ãŠç¥ã„ã€‚ãƒã‚¤ãƒ©ã‚¤ãƒˆæ™‚ã«ã€‚ |
| support | ä¸€ç·’ã«ãŒã‚“ã°ã‚ | ğŸ¤ | ä¼´èµ°æ„Ÿãƒ»ä»²é–“æ„Ÿã€‚åŒã˜ã‚«ãƒ†ã‚´ãƒªã§é ‘å¼µã£ã¦ã„ã‚‹å…±æ„Ÿã€‚ |

### 5.2 è¨­è¨ˆæ ¹æ‹ 

- **3ç¨®ã«çµã£ãŸç†ç”±**: èªçŸ¥è² è·ã‚’ä¸‹ã’ã€Œè¿·ã‚ãšé¸ã¹ã‚‹ã€ã“ã¨ã‚’å„ªå…ˆ
- **respectï¼ˆå°Šæ•¬ï¼‰ä¸æ¡ç”¨**: æ—¥å¸¸ã®å°ã•ãªç¿’æ…£ã«ã¯é‡ã™ãã‚‹
- **competeï¼ˆè² ã‘ãªã„ãï¼‰ä¸æ¡ç”¨**: æ”»æ’ƒçš„ã«å—ã‘å–ã‚‰ã‚Œã‚‹ãƒªã‚¹ã‚¯ã€å®Œç’§ä¸»ç¾©ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼æ‡¸å¿µ

---

## 6. ç”»é¢ä¸€è¦§ï¼ˆMVPï¼‰

### 6.1 ç”»é¢æ§‹æˆ

| ç”»é¢ID | ç”»é¢å | ãƒ•ã‚¡ã‚¤ãƒ« | èª¬æ˜ |
|--------|--------|----------|------|
| S01 | ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ | app/index.tsx | èµ·å‹•ç”»é¢ã€åˆå›åˆ¤å®š |
| S02 | ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚° | app/onboarding.tsx | åˆå›èµ·å‹•æ™‚ã®èª¬æ˜ï¼ˆ3ç”»é¢ï¼‰ |
| S03 | ãƒ›ãƒ¼ãƒ  | app/(tabs)/home.tsx | ã‚«ãƒ¼ãƒ‰ä¸€è¦§ã€ä»Šæ—¥ã®è¨˜éŒ²çŠ¶æ³ |
| S04 | ã‚«ãƒ¼ãƒ‰è¿½åŠ ï¼ˆL1é¸æŠï¼‰ | app/add-card.tsx | ã‚«ãƒ†ã‚´ãƒªL1é¸æŠ |
| S04-2 | ã‚«ãƒ¼ãƒ‰è¿½åŠ ï¼ˆL2/ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼‰ | app/select-card.tsx | ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠ |
| S04-3 | ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚«ãƒ¼ãƒ‰ä½œæˆ | app/create-custom-card.tsx | ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ¼ãƒ‰ä½œæˆ |
| S05 | ã‚«ãƒ¼ãƒ‰è©³ç´° | app/card-detail/[id].tsx | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼è¡¨ç¤ºã€çµ±è¨ˆã€ãƒãƒƒã‚¸ |
| S05-2 | ã‚«ãƒ¼ãƒ‰ç·¨é›† | app/edit-card.tsx | ã‚¿ã‚¤ãƒˆãƒ«ãƒ»å…¬é–‹è¨­å®šãƒ»ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ç·¨é›† |
| S06 | ã‚¨ãƒ¼ãƒ«ææ¡ˆ | app/(tabs)/cheers.tsx | ä»–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®ã‚¨ãƒ¼ãƒ«é€ä¿¡ |
| S07 | é€šçŸ¥ä¸€è¦§ | app/(tabs)/notifications.tsx | å—ã‘å–ã£ãŸã‚¨ãƒ¼ãƒ«ä¸€è¦§ |
| S08 | è¨­å®š | app/(tabs)/settings.tsx | ã‚¨ãƒ¼ãƒ«é »åº¦ã€é€šçŸ¥è¨­å®š |
| S08-2 | ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤ | app/settings/account-deletion.tsx | é€€ä¼šæ©Ÿèƒ½ |
| S09 | ä»Šæ—¥ã®ã‚¨ãƒ¼ãƒ« | app/today-cheers.tsx | ã¾ã¨ã‚ã¦é€šçŸ¥ã‚¿ãƒƒãƒ—æ™‚ã®é·ç§»å…ˆ |
| S10 | ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ä¸€è¦§ | app/archived-cards.tsx | ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã—ãŸã‚«ãƒ¼ãƒ‰ã®ç®¡ç† |
| S11 | ãŠæ°—ã«å…¥ã‚Šä¸€è¦§ | app/favorites.tsx | ãŠæ°—ã«å…¥ã‚Šã®ä»²é–“ã®ç®¡ç†ï¼ˆPhase 10-Aï¼‰ |

### 6.2 ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ»çµ±è¨ˆè¡¨ç¤ºè¨­è¨ˆ

#### 6.2.1 è¡¨ç¤ºæ–¹é‡ï¼ˆè¡Œå‹•å¿ƒç†å­¦ã«åŸºã¥ãï¼‰

| é …ç›® | è¨­è¨ˆ | ç†ç”± |
|------|------|------|
| é”æˆæ—¥ | ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚«ãƒ©ãƒ¼ã§è¡¨ç¤º | é”æˆã‚’è¦–è¦šçš„ã«å¼·èª¿ |
| æœªé”æˆæ—¥ | ç„¡è‰² or è–„ã‚°ãƒ¬ãƒ¼ | ã€Œç©´ã€ã‚’ä¸»å¼µã•ã›ãªã„ã€å¤±æ•—æ„Ÿã‚’è»½æ¸› |
| ãƒ¡ã‚¤ãƒ³æŒ‡æ¨™ | ã€Œä»Šé€±â—‹æ—¥ã€ã€Œä»Šæœˆâ—‹æ—¥ã€ | ç´¯ç©ãƒ»å¢—åˆ†æŒ‡æ¨™ã§å‰å‘ãã« |
| ã‚¹ãƒˆãƒªãƒ¼ã‚¯ | ã‚«ãƒ¼ãƒ‰è©³ç´°ç”»é¢ã§ã‚µãƒ–è¡¨ç¤º | é€”åˆ‡ã‚Œã®ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’è»½æ¸› |

#### 6.2.2 å†é–‹ã‚±ã‚¢

| æ©Ÿèƒ½ | å†…å®¹ |
|------|------|
| ãŠã‹ãˆã‚Šæ¼”å‡º | 3æ—¥ä»¥ä¸Šç©ºã„ã¦è¨˜éŒ²æ™‚ã«ã€ŒãŠã‹ãˆã‚Šã€ãƒ¢ãƒ¼ãƒ€ãƒ« + ç´™å¹é›ªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ |
| å¾©æ´»ãƒãƒƒã‚¸ | ä¸­æ–­å¾Œã«3æ—¥å†é–‹ã§ã€Œå¾©æ´»ã®ä¸€æ­©ã€ãƒãƒƒã‚¸ç²å¾— |

### 6.3 ç”»é¢é·ç§»

```
[ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ S01]
    â”‚
    â”œâ”€(åˆå›)â†’ [ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚° S02] â†’ [ãƒ›ãƒ¼ãƒ  S03]
    â”‚
    â””â”€(2å›ç›®ä»¥é™)â†’ [ãƒ›ãƒ¼ãƒ  S03]
                      â”‚
                      â”œâ†’ [ã‚«ãƒ¼ãƒ‰è©³ç´° S05]
                      â”‚    â””â†’ [ã‚«ãƒ¼ãƒ‰ç·¨é›† S05-2]
                      â”‚         â”œâ†’ [å‰Šé™¤ãƒ€ã‚¤ã‚¢ãƒ­ã‚°]
                      â”‚         â””â†’ [ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãƒ€ã‚¤ã‚¢ãƒ­ã‚°]
                      â”‚
                      â”œâ†’ [ã‚«ãƒ¼ãƒ‰è¿½åŠ  S04]
                      â”‚    â””â†’ [L2/ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠ S04-2]
                      â”‚         â”œâ†’ [ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°] â†’ [ãƒ›ãƒ¼ãƒ ]
                      â”‚         â””â†’ [ã‚ªãƒªã‚¸ãƒŠãƒ«ä½œæˆ S04-3] â†’ [ãƒ›ãƒ¼ãƒ ]
                      â”‚
                      â”œâ†’ [ã‚¨ãƒ¼ãƒ«ææ¡ˆ S06] â† ã‚¿ãƒ–
                      â”‚
                      â”œâ†’ [é€šçŸ¥ä¸€è¦§ S07] â† ã‚¿ãƒ–
                      â”‚    â””â†’ [ä»Šæ—¥ã®ã‚¨ãƒ¼ãƒ« S09]
                      â”‚
                      â”œâ†’ [è¨­å®š S08] â† ã‚¿ãƒ–
                      â”‚    â””â†’ [ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤ S08-2]
                      â”‚
                      â””â†’ [ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ä¸€è¦§ S10]
                           â””â†’ å¾©å…ƒ â†’ [ãƒ›ãƒ¼ãƒ ]
```

---

## 7. ã‚¨ãƒ¼ãƒ«æ©Ÿèƒ½

### 7.1 AIã‚¨ãƒ¼ãƒ«ï¼ˆPhase 7ï¼‰

#### 7.1.1 é€ä¿¡ãƒ‘ã‚¿ãƒ¼ãƒ³

| ãƒ‘ã‚¿ãƒ¼ãƒ³ | reason | ãƒˆãƒªã‚¬ãƒ¼ | é€ä¿¡é »åº¦ | ã‚¿ã‚¤ãƒŸãƒ³ã‚° |
|----------|--------|----------|----------|------------|
| â‘  è¨˜éŒ²ç›´å¾Œ | record | ãƒ­ã‚°ä½œæˆæ™‚ | è¨˜éŒ²ã”ã¨ | 5ã€œ45åˆ†å¾Œï¼ˆãƒ©ãƒ³ãƒ€ãƒ ï¼‰ |
| â‘¡ ç¶™ç¶šé€”åˆ‡ã‚Œç¿Œæ—¥ | streak_break | æ¯æœ9æ™‚ãƒãƒƒãƒ | é€±2å›ã¾ã§ | å‰æ—¥æœªè¨˜éŒ²ã®ã‚«ãƒ¼ãƒ‰ |
| â‘¢ é•·æœŸé›¢è„± | long_absence | æ¯æœ9æ™‚ãƒãƒƒãƒ | ã‚«ãƒ¼ãƒ‰ã”ã¨3å›ã¾ã§ | 7æ—¥/21æ—¥/35æ—¥é›¢è„±æ™‚ |
| â‘£ ãƒ©ãƒ³ãƒ€ãƒ  | random | 6æ™‚é–“ã”ã¨ | 33%ã®ç¢ºç‡ | ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼å¯¾è±¡ |

**1æ—¥ã®ä¸Šé™**: 3ä»¶ï¼ˆå…¨ãƒ‘ã‚¿ãƒ¼ãƒ³åˆè¨ˆï¼‰

#### 7.1.2 ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç¨®åˆ¥é¸æŠã®é‡ã¿ä»˜ã‘

| reason | cheer (ğŸ’ª) | amazing (â­) | support (ğŸ¤) |
|--------|-----------|-------------|-------------|
| record | 65% | 20% | 15% |
| streak_break | 30% | 10% | 60% |
| long_absence | 15% | 5% | 80% |
| random | 33% | 33% | 34% |

**è¨­è¨ˆæ„å›³**:
- **record**: ç¶™ç¶šã‚’åŠ±ã¾ã™ã€Œcheerã€ã‚’å¤šã‚ã«
- **streak_break**: å¯„ã‚Šæ·»ã†ã€Œsupportã€ã‚’å¤šã‚ã«
- **long_absence**: ã•ã‚‰ã«å¯„ã‚Šæ·»ã†ã€Œsupportã€ã‚’åœ§å€’çš„ã«å¤šã
- **random**: å‡ç­‰é…åˆ†

#### 7.1.3 AIã‚¨ãƒ¼ãƒ«æ–‡è¨€ï¼ˆ67ç¨®é¡ï¼‰

**ãƒ‘ã‚¿ãƒ¼ãƒ³â‘ : è¨˜éŒ²ç›´å¾Œ (record)**

| reactionType | æ–‡è¨€ |
|--------------|------|
| cheer (ğŸ’ª) | ä»Šæ—¥ã‚‚ãƒŠã‚¤ã‚¹ç¶™ç¶š / ã„ã„æµã‚Œãã¦ã¾ã™ / ãã®ä¸€æ­©ã™ã¦ã / ç©ã¿é‡ã­ãŒå…‰ã£ã¦ã‚‹ / ãƒšãƒ¼ã‚¹ã€ã„ã„æ„Ÿã˜ / ä»Šæ—¥ã®ä¸€æ­©ã‚‚ä¸Šã€… |
| amazing (â­) | ã™ã”ãã„ã„ãƒšãƒ¼ã‚¹ / ä»Šæ—¥ã‚‚ã‚­ãƒ¬ã¦ã‚‹ / ç¶šã‘æ–¹ãŒã†ã¾ã„ã­ / ã„ã„ãƒªã‚ºãƒ å‡ºã¦ã‚‹ / æµã‚Œã¤ã‹ã‚“ã§ã‚‹ã­ / ä¼¸ã³æ–¹ãŒã™ã¦ã |
| support (ğŸ¤) | ä¸€ç·’ã«ãŒã‚“ã°ã£ã¦ã‚‹ã‚ˆ / ã“ã£ã¡ã‚‚ä»Šã‚„ã£ã¦ã‚‹ / åŒã˜ç©ºæ°—ã§é€²ã‚“ã§ã‚‹ / ä»²é–“ã‚‚ä»Šã‚„ã£ã¦ã‚‹ã‚ˆ / ä»Šæ—¥ã‚‚ä¸¦ã‚“ã§æ­©ã“ã† / ã¨ãªã‚Šã§èµ°ã£ã¦ã‚‹æ„Ÿ |

**ãƒ‘ã‚¿ãƒ¼ãƒ³â‘¡: ç¶™ç¶šé€”åˆ‡ã‚Œç¿Œæ—¥ (streak_break)**

| reactionType | æ–‡è¨€ |
|--------------|------|
| cheer (ğŸ’ª) | ä»Šæ—¥ã‹ã‚‰ã¾ãŸä¸€æ­©ã©ã†ï¼Ÿ / ã‚†ã£ãã‚Šæˆ»ã£ã¦ã“ã‚ˆ / ä»Šæ—¥ã®ä¸€æ­©ã‹ã‚‰ã§OK / æ€ã„å‡ºã—ãŸã‚‰ä¸€æ­©ã ã‘ / ã§ãã‚‹æ—¥ã«ã‚„ã‚Œã°OK / è»½ãä¸€æ­©è¸ã¿å‡ºã |
| amazing (â­) | ã¾ãŸã™ã”ã„æ—¥ãŒæ¥ãã† / ç©ã¿é‡ã­ç›´å‰ã£ã¦æ„Ÿã˜ / æ¬¡ã®ä¸€æ­©ãŒæ¥½ã—ã¿ / ã“ã“ã‹ã‚‰ãŒé¢ç™½ã„ã­ / ã¾ãŸä¼¸ã³ã¦ã„ããã† / æœªæ¥ã®è‡ªåˆ†ãŒæ¥½ã—ã¿ |
| support (ğŸ¤) | å°‘ã—ä¼‘ã‚“ã§OK ã¾ãŸä¸€ç·’ã« / ã“ã“ã‹ã‚‰ã¾ãŸä¸¦èµ°ã—ã‚ˆ / ã„ã¤ã§ã‚‚éš£ã§æ­©ã‘ã‚‹ã‚ˆ / ãƒšãƒ¼ã‚¹æˆ»ã™ã¨ãå¯„ã£ã¦ã­ / ä»Šæ—¥ã¯ä¸€ç·’ã«ã©ã†ï¼Ÿ / ã¾ãŸä¸¦ã‚“ã§é€²ã‚‚ã†ã‹ |

**ãƒ‘ã‚¿ãƒ¼ãƒ³â‘¢: é•·æœŸé›¢è„± (long_absence)**

| reactionType | æ–‡è¨€ |
|--------------|------|
| cheer (ğŸ’ª) | æ€ã„å‡ºã—ãŸã‚‰ä¸€æ­©ã ã‘ / ã¾ãŸã„ã¤ã§ã‚‚å†é–‹OK / ä¹…ã—ã¶ã‚Šã®ä¸€æ­©ã©ã†ï¼Ÿ / ä¸€æ­©ç›®ã¯ã„ã¤ã§ã‚‚è»½ã / å°ã•ãå†é–‹ã—ã¦ã¿ã‚ˆ / æ°—ãŒå‘ã„ãŸã‚‰ã‚¿ãƒƒãƒ—ã ã‘ |
| amazing (â­) | ã¾ãŸã™ã”ã„æ—¥ãŒæ¥ãã†ï¼ˆâ€»1ç¨®é¡ã®ã¿ï¼‰ |
| support (ğŸ¤) | ã„ã¤ã§ã‚‚ã“ã“ã§å¾…ã£ã¦ã‚‹ / ã¾ãŸä¸€ç·’ã«å§‹ã‚ã‚ˆ / é›¢ã‚Œã¦ã¦ã‚‚ä»²é–“ã ã‚ˆ / æˆ»ã‚‹å ´æ‰€ã¯ã“ã“ã ã‚ˆ / æ€ã„å‡ºã—ãŸã‚‰ä¼šãŠã† / ãµã‚‰ã£ã¨æˆ»ã£ã¦ãŠã„ã§ |

**ãƒ‘ã‚¿ãƒ¼ãƒ³â‘£: ãƒ©ãƒ³ãƒ€ãƒ  (random)**

| reactionType | æ–‡è¨€ |
|--------------|------|
| cheer (ğŸ’ª) | ãã®ãƒšãƒ¼ã‚¹ã™ã”ãã„ã„ / ç©ã¿é‡ã­ãŒåŠ¹ã„ã¦ã‚‹ / æ—¥ã€…ã®ä¸€æ­©ãŒå…‰ã£ã¦ã‚‹ / ãƒã‚¤ãƒšãƒ¼ã‚¹ãŒä¸€ç•ªã„ã„ / åœ°å‘³ã«ã™ã”ã„ã“ã¨ã—ã¦ã‚‹ / ä»Šæ—¥ã‚‚ã„ã„ãƒªã‚ºãƒ ã ã­ |
| amazing (â­) | ã‚³ãƒ„ã‚³ãƒ„ãŒã™ã”ã„åŠ›ã« / æœ€è¿‘ã®è¨˜éŒ²ã¨ã¦ã‚‚ã„ã„ / ã‚„ã‚Šæ–¹ãŒã»ã‚“ã¨ä¸Šæ‰‹ / ç©ã¿é‡ã­ãŒå°Šæ•¬ãƒ¬ãƒ™ãƒ« / ãã®ç¶™ç¶šã€æ™®é€šã«ã™ã”ã„ / ã˜ã‚ã˜ã‚ä¼¸ã³ã¦ã‚‹ã­ |
| support (ğŸ¤) | é ãã§ä¸€ç·’ã«ã‚„ã£ã¦ã‚‹ã‚ˆ / åŒã˜ã‚«ãƒ¼ãƒ‰ã®ä»²é–“ã§ã™ / ã¿ã‚“ãªã§å°‘ã—ãšã¤å‰ã¸ / ã©ã“ã‹ã§ä¸¦èµ°ã—ã¦ã¾ã™ / ä»Šæ—¥ã‚‚ä»²é–“ãŒãã°ã«ã„ã‚‹ / åŒã˜æ–¹å‘å‘ã„ã¦ã‚‹ã‚ˆ |

#### 7.1.4 æ–‡è¨€é¸æŠãƒ­ã‚¸ãƒƒã‚¯

1. ç›´è¿‘5ä»¶ã®AIã‚¨ãƒ¼ãƒ«æ–‡è¨€ã‚’å–å¾—
2. é‡è¤‡å›é¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
3. å€™è£œãŒ0ä»¶ãªã‚‰å…¨æ–‡è¨€ã‹ã‚‰é¸æŠ
4. ãƒ©ãƒ³ãƒ€ãƒ ã«1ã¤é¸æŠ

### 7.2 äººé–“ã‚¨ãƒ¼ãƒ«ï¼ˆPhase 8ï¼‰

#### 7.2.1 ãƒãƒƒãƒãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯

**å‡¦ç†ãƒ•ãƒ­ãƒ¼ï¼ˆ30åˆ†ã”ã¨å®Ÿè¡Œï¼‰**:

1. å…¨ã‚«ãƒ†ã‚´ãƒªL3ã‚’å–å¾—
2. å„ã‚«ãƒ†ã‚´ãƒªã§ä»¥ä¸‹ã‚’å®Ÿè¡Œ:
   - å…¬é–‹ã‚«ãƒ¼ãƒ‰å–å¾— (`is_public=true`)
   - 7æ—¥ä»¥å†…ã«è¨˜éŒ²ã‚ã‚Š (`last_log_date >= 7æ—¥å‰`)
   - is_comebackåˆ¤å®š (ç›´è¿‘2ãƒ­ã‚°ã®å·®åˆ†â‰§4æ—¥)
   - ã‚·ãƒ£ãƒƒãƒ•ãƒ«
   - ä¸Šä½100ä»¶ã«åˆ¶é™
   - `matching_pools` ã«ä¿å­˜

**å¯¾è±¡æ¡ä»¶**:
- `category_l3` ãŒä¸€è‡´
- `is_public == true`
- `last_log_date` ãŒ7æ—¥ä»¥å†…

**é™¤å¤–æ¡ä»¶**:
- éå…¬é–‹ã‚«ãƒ¼ãƒ‰
- è¨˜éŒ²ãŒä¸€åº¦ã‚‚ãªã„æ–°è¦ã‚«ãƒ¼ãƒ‰
- éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆ7æ—¥ä»¥ä¸Šè¨˜éŒ²ãªã—ï¼‰

**is_comebackåˆ¤å®š**:
- ç›´è¿‘2ä»¶ã®ãƒ­ã‚°å·®åˆ†ãŒ4æ—¥ä»¥ä¸Š â†’ `true`

#### 7.2.2 é€ä¿¡åˆ¶é™

| åˆ¶é™ | å€¤ |
|------|-----|
| 1æ—¥ã®é€ä¿¡ä¸Šé™ | 10ä»¶/ãƒ¦ãƒ¼ã‚¶ãƒ¼ |
| åŒä¸€ãƒšã‚¢ã¸ã®é€ä¿¡ | 24æ™‚é–“ã«1å› |

#### 7.2.3 ã‚¢ãƒ³ãƒ‰ã‚¥æ©Ÿèƒ½

- é€ä¿¡ç›´å¾Œ3ç§’é–“ã€å–ã‚Šæ¶ˆã—å¯èƒ½
- ã‚¹ãƒŠãƒƒã‚¯ãƒãƒ¼ã§ã€Œå–ã‚Šæ¶ˆã™ã€ãƒœã‚¿ãƒ³è¡¨ç¤º

---

## 8. é€šçŸ¥è¨­è¨ˆ

### 8.1 é€šçŸ¥ç¨®åˆ¥

| ç¨®åˆ¥ | ãƒˆãƒªã‚¬ãƒ¼ | å†…å®¹ |
|------|----------|------|
| ã‚¨ãƒ¼ãƒ«å—ä¿¡ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼‰ | reactionsä½œæˆæ™‚ | ã€Œ{ã‚«ãƒ†ã‚´ãƒª}ã®ä»²é–“ã‹ã‚‰ã‚¨ãƒ¼ãƒ«ãŒå±Šãã¾ã—ãŸã€ |
| ã‚¨ãƒ¼ãƒ«å—ä¿¡ï¼ˆã¾ã¨ã‚ã¦ï¼‰ | è¨­å®šæ™‚åˆ» | ã€Œä»Šæ—¥â—‹ä»¶ã®ã‚¨ãƒ¼ãƒ«ãŒå±Šã„ã¦ã„ã¾ã™ã€ |
| ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ | è¨­å®šæ™‚åˆ»ï¼ˆ15åˆ†ã”ã¨ç¢ºèªï¼‰ | ã€Œä»Šæ—¥ã®ã€‡ã€‡ã€1ã‚¿ãƒƒãƒ—ã§è¨˜éŒ²ã§ãã¾ã™ã€ |

### 8.2 é€šçŸ¥ãƒ¢ãƒ¼ãƒ‰

| ãƒ¢ãƒ¼ãƒ‰ | èª¬æ˜ |
|--------|------|
| realtime | ã‚¨ãƒ¼ãƒ«å—ä¿¡æ™‚ã«å³åº§ã«é€šçŸ¥ |
| batch | è¨­å®šæ™‚åˆ»ã«ã¾ã¨ã‚ã¦é€šçŸ¥ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 12:00, 18:00, 22:00ï¼‰ |

### 8.3 ãŠä¼‘ã¿ãƒ¢ãƒ¼ãƒ‰

| è¨­å®š | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ |
|------|------------|
| quiet_hours_enabled | true |
| quiet_hours_start | "23:00" |
| quiet_hours_end | "07:00" |

### 8.4 é€šçŸ¥æ–‡è¨€ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

**NGãƒ¯ãƒ¼ãƒ‰ï¼ˆä½¿ç”¨ç¦æ­¢ï¼‰**:
- ã€Œã¾ã ã€ã€Œã‚µãƒœã‚Šã€ã€Œã‚„ã£ã¦ã„ã¾ã›ã‚“ã€ãªã©ç½ªæ‚ªæ„Ÿã‚’å–šèµ·ã™ã‚‹è¡¨ç¾
- ã€Œã€œã—ãªã•ã„ã€ã€Œã€œã™ã¹ãã€ãªã©å‘½ä»¤å½¢
- ã€Œã‚¹ãƒˆãƒªãƒ¼ã‚¯ãŒå¤±ã‚ã‚Œã¾ã™ã€ãªã©è„…è¿«çš„è¡¨ç¾

**æ¨å¥¨ãƒˆãƒ¼ãƒ³**:
- å„ªã—ãèª˜ã†ï¼šã€Œã€œã—ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿã€
- é¸æŠã‚’å°Šé‡ï¼šã€Œ1ã‚¿ãƒƒãƒ—ã§è¨˜éŒ²ã§ãã¾ã™ã€
- ãƒã‚¸ãƒ†ã‚£ãƒ–ï¼šã€Œä»Šæ—¥ã‚‚ä¸€ç·’ã«ãŒã‚“ã°ã‚ã†ã€

---

## 9. ã‚²ãƒ¼ãƒŸãƒ•ã‚£ã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­è¨ˆ

### 9.1 è¨­è¨ˆæ–¹é‡

- **è»½ã•æœ€å„ªå…ˆ**: Habiticaã®ã‚ˆã†ãªé‡ã„RPGåŒ–ã¯é¿ã‘ã‚‹
- **ç«¶äº‰ã‚ˆã‚Šå…±èµ°**: ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ»æ¯”è¼ƒè¦ç´ ã¯éæ¡ç”¨
- **å¤±æ•—ã‚’è²¬ã‚ãªã„**: å†é–‹ãƒ»å¾©æ´»ã‚’ç§°ãˆã‚‹è¨­è¨ˆ

### 9.2 ãƒãƒƒã‚¸ï¼ˆ5ç¨®ï¼‰

| ãƒãƒƒã‚¸å | ã‚¢ã‚¤ã‚³ãƒ³ | æ¡ä»¶ | æ„å›³ |
|----------|----------|------|------|
| 3æ—¥ç¶™ç¶š | ğŸ¥‰ | é€£ç¶š3æ—¥é”æˆ | ã‚¹ã‚¿ãƒ¼ãƒˆã®ç§°è³› |
| 7æ—¥ç¶™ç¶š | ğŸ¥ˆ | é€£ç¶š7æ—¥é”æˆ | 1é€±é–“ã®ç¯€ç›® |
| 21æ—¥ç¶™ç¶š | ğŸ¥‡ | é€£ç¶š21æ—¥é”æˆ | ç¿’æ…£åŒ–ã®é”äºº |
| å¾©æ´»ã®ä¸€æ­© | â¤ï¸â€ğŸ”¥ | ä¸­æ–­å¾Œã«3æ—¥é€£ç¶šå†é–‹ | å†é–‹ã‚’ç§°ãˆã‚‹ |
| 100å›è¨˜éŒ² | ğŸ’ | ç´¯è¨ˆ100å›é”æˆ | é•·æœŸç¶™ç¶šã®ç§°è³› |

**å¾©æ´»ã®ä¸€æ­©ã®åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯**:
- ç¾åœ¨ã®ã‚¹ãƒˆãƒªãƒ¼ã‚¯ãŒ3æ—¥ä»¥ä¸Š
- ã‹ã¤å…¨ãƒ­ã‚°æ•°ãŒã‚¹ãƒˆãƒªãƒ¼ã‚¯ã‚ˆã‚Šã‚‚å¤šã„ï¼ˆ= éå»ã«ã‚®ãƒ£ãƒƒãƒ—ãŒã‚ã£ãŸï¼‰

### 9.3 éæ¡ç”¨è¦ç´ 

| è¦ç´  | ç†ç”± |
|------|------|
| ãƒ¬ãƒ™ãƒ«/çµŒé¨“å€¤ | è»½ã•ã‚’æãªã†ã€UIãŒé‡ããªã‚‹ |
| ãƒ©ãƒ³ã‚­ãƒ³ã‚° | ç«¶äº‰ãƒ»æ¯”è¼ƒã‚’ç…½ã‚Šã€SNSç–²ã‚Œã¨ç›¸æ€§æ‚ªã„ |
| é€£ç¶šæ—¥æ•°ãƒªã‚»ãƒƒãƒˆå¼·èª¿ | å®Œç’§ä¸»ç¾©ã‚’åŠ©é•·ã€é›¢è„±ãƒªã‚¹ã‚¯ |

---

## 10. ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¨­è¨ˆ

### 10.1 è¨­è¨ˆæ–¹é‡

- **ã€Œã¾ãš1ã¤ã ã‘ã€ã‚’å¼·ãæ¨å¥¨**: è¤‡æ•°ç¿’æ…£ã®åŒæ™‚ç«‹ã¡ä¸Šã’ã¯å¤±æ•—ã—ã‚„ã™ã„
- **ã€Œå°ã•ãå§‹ã‚ã‚‹ã€ã‚’ä¿ƒã™**: ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ã€Œ1åˆ†ã§çµ‚ã‚ã‚‹ã€ãƒ¬ãƒ™ãƒ«ã‚’æ¨å¥¨
- **åˆé€±ã§ã‚¨ãƒ¼ãƒ«ä½“é¨“ã‚’å®Œäº†**: é€å—ä¿¡ä¸¡æ–¹ã‚’ä½“é¨“ã•ã›ã‚‹

### 10.2 ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ï¼ˆ3ç”»é¢ï¼‰

| ç”»é¢ | ã‚¿ã‚¤ãƒˆãƒ« | å†…å®¹ |
|------|----------|------|
| 1 | å°ã•ãªä¸€æ­© | ã€Œ1ã‚¿ãƒƒãƒ—ã§è¨˜éŒ²ã€ã®èª¬æ˜ |
| 2 | ä»²é–“ã‹ã‚‰ã®ã‚¨ãƒ¼ãƒ« | ã€ŒğŸ’ªâ­ğŸ¤ æ–‡å­—ã‚’æ‰“ãŸãªãã¦ã‚‚æ°—æŒã¡ã¯ä¼ã‚ã‚‹ã€ |
| 3 | ã•ã‚ã€å§‹ã‚ã¾ã—ã‚‡ã† | ã€ŒåŒã˜ç¿’æ…£ã‚’ç¶šã‘ã‚‹ä»²é–“ã¨ã‚†ã‚‹ãç¹‹ãŒã‚‹ã€ |

### 10.3 åˆå›èµ·å‹•åˆ¤å®š

- AsyncStorageã§ `onboarding_completed` ãƒ•ãƒ©ã‚°ã‚’ç®¡ç†
- æœªå®Œäº† â†’ ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
- å®Œäº†æ¸ˆã¿ â†’ ãƒ›ãƒ¼ãƒ ç”»é¢ã¸

---

## 11. Cloud Functions

### 11.1 é–¢æ•°ä¸€è¦§

| é–¢æ•°å | ãƒˆãƒªã‚¬ãƒ¼ | å‡¦ç†æ¦‚è¦ |
|--------|----------|----------|
| onLogCreated | Firestore onCreate (logs) | ã‚¹ãƒˆãƒªãƒ¼ã‚¯è¨ˆç®—ã€AIã‚¨ãƒ¼ãƒ«ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ« |
| sendDelayedCheer | Cloud Scheduler (1åˆ†ã”ã¨) | é…å»¶AIã‚¨ãƒ¼ãƒ«ã®é…ä¿¡ |
| checkStreakBreak | Cloud Scheduler (æ¯æœ9æ™‚) | ç¶™ç¶šé€”åˆ‡ã‚Œãƒ»é•·æœŸé›¢è„±ã‚¨ãƒ¼ãƒ«é€ä¿¡ |
| sendRandomCheer | Cloud Scheduler (6æ™‚é–“ã”ã¨) | ãƒ©ãƒ³ãƒ€ãƒ ã‚¨ãƒ¼ãƒ«é€ä¿¡ |
| deliverBatchNotifications | Cloud Scheduler (æ¯æ™‚0åˆ†) | ã¾ã¨ã‚ã¦é€šçŸ¥é…ä¿¡ |
| updateMatchingPools | Cloud Scheduler (30åˆ†ã”ã¨) | ãƒãƒƒãƒãƒ³ã‚°ãƒ—ãƒ¼ãƒ«æ›´æ–° |
| onHumanCheerSent | Firestore onCreate (reactions) | äººé–“ã‚¨ãƒ¼ãƒ«é€ä¿¡æ™‚ã®FCMé€šçŸ¥ |
| onCardDeleted | Firestore onDelete (cards) | ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰å‰Šé™¤ï¼ˆlogs, reactionsï¼‰ |
| onUserDeleted | Auth onDelete | å…¨é–¢é€£ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— |
| sendReminders | Cloud Scheduler (15åˆ†ã”ã¨) | ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼é€šçŸ¥é€ä¿¡ |

---

## 12. Firestoreã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // ========================================
    // users: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
    // ========================================
    match /users/{uid} {
      // èª­ã¿å–ã‚Š: èªè¨¼æ¸ˆã¿å…¨å“¡ï¼ˆdisplay_nameå–å¾—ã®ãŸã‚ï¼‰
      // TODO: æœ¬ç•ªå‰ã« public_profiles ã‚µãƒ–ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³åŒ–ã‚’æ¤œè¨
      allow read: if request.auth != null;
      
      // æ›¸ãè¾¼ã¿: æœ¬äººã®ã¿
      allow write: if request.auth != null && request.auth.uid == uid;
    }

    // ========================================
    // cards: ç¿’æ…£ã‚«ãƒ¼ãƒ‰
    // ========================================
    match /cards/{cardId} {
      // èª­ã¿å–ã‚Š: æœ¬äºº OR å…¬é–‹ã‚«ãƒ¼ãƒ‰
      allow read: if request.auth != null && (
        resource.data.owner_uid == request.auth.uid ||
        resource.data.is_public == true ||
        resource.data.is_public_for_cheers == true
      );
      
      // ä½œæˆ: æœ¬äººã®ã¿
      allow create: if request.auth != null 
        && request.resource.data.owner_uid == request.auth.uid;
      
      // æ›´æ–°ãƒ»å‰Šé™¤: æœ¬äººã®ã¿
      allow update, delete: if request.auth != null 
        && resource.data.owner_uid == request.auth.uid;
    }

    // ========================================
    // logs: é”æˆãƒ­ã‚°
    // ========================================
    match /logs/{logId} {
      allow read: if request.auth != null 
        && resource.data.owner_uid == request.auth.uid;
      allow create: if request.auth != null 
        && request.resource.data.owner_uid == request.auth.uid;
      allow update, delete: if request.auth != null 
        && resource.data.owner_uid == request.auth.uid;
    }

    // ========================================
    // categories, card_templates: ãƒã‚¹ã‚¿ãƒ‡ãƒ¼ã‚¿
    // ========================================
    match /categories/{doc} {
      allow read: if request.auth != null;
      allow write: if false;
    }
    
    match /card_templates/{doc} {
      allow read: if request.auth != null;
      allow write: if false;
    }

    // ========================================
    // matching_pools: ãƒãƒƒãƒãƒ³ã‚°ãƒ—ãƒ¼ãƒ«
    // ========================================
    match /matching_pools/{doc} {
      allow read: if request.auth != null;
      allow write: if false;  // Cloud Functionsã®ã¿
    }

    // ========================================
    // reactions: ã‚¨ãƒ¼ãƒ«ï¼ˆãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼‰
    // ========================================
    match /reactions/{reactionId} {
      // ä½œæˆ: èªè¨¼æ¸ˆã¿ã€ã‹ã¤ from_uid ã¯è‡ªåˆ†è‡ªèº«
      // â€» from_uid="system" ã¯ Cloud Functions (Admin SDK) ã®ã¿
      allow create: if request.auth != null 
        && request.resource.data.from_uid == request.auth.uid;
      
      // èª­ã¿å–ã‚Š: é€ä¿¡è€… OR å—ä¿¡è€…
      allow read: if request.auth != null && (
        resource.data.from_uid == request.auth.uid ||
        resource.data.to_uid == request.auth.uid
      );
      
      // æ›´æ–°: å—ä¿¡è€…ã®ã¿ï¼ˆis_readæ›´æ–°ç”¨ï¼‰
      allow update: if request.auth != null 
        && resource.data.to_uid == request.auth.uid;
      
      // å‰Šé™¤: é€ä¿¡è€…ã®ã¿ï¼ˆã‚¢ãƒ³ãƒ‰ã‚¥ç”¨ï¼‰
      allow delete: if request.auth != null 
        && resource.data.from_uid == request.auth.uid;
    }

    // ========================================
    // cheer_state: AIã‚¨ãƒ¼ãƒ«çŠ¶æ…‹ç®¡ç†
    // ========================================
    match /cheer_state/{docId} {
      allow read: if request.auth != null && docId == request.auth.uid;
      allow write: if false;  // Cloud Functionsã®ã¿
    }

    // ========================================
    // cheer_send_state: äººé–“ã‚¨ãƒ¼ãƒ«é€ä¿¡åˆ¶é™
    // ========================================
    match /cheer_send_state/{docId} {
      allow read, write: if request.auth != null && docId == request.auth.uid;
    }

    // ========================================
    // favorites: ãŠæ°—ã«å…¥ã‚Š
    // ========================================
    match /favorites/{docId} {
      allow create: if request.auth != null 
        && request.resource.data.owner_uid == request.auth.uid;
      allow read, delete: if request.auth != null 
        && resource.data.owner_uid == request.auth.uid;
      allow update: if false;
    }
  }
}
```

**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ï¼ˆPhase 10-Bã§å¯¾å¿œæ¸ˆã¿ï¼‰**:
- `reactions` ã® `create` ã§ `from_uid` ã‚’ `request.auth.uid` ã«é™å®šï¼ˆ`from_uid="system"` ã¯Cloud Functionsã®ã¿ï¼‰
- `cards` ã® `read` ã§éå…¬é–‹ã‚«ãƒ¼ãƒ‰ï¼ˆ`is_public=false` ã‹ã¤ `is_public_for_cheers=false`ï¼‰ã‚’ä»–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ä¿è­·
- `categories` ã® `write` ã‚’å®Œå…¨ç¦æ­¢ï¼ˆãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ç”¨ã®ä¸€æ™‚ç·©å’Œã‚’è§£é™¤ï¼‰

---

## 13. éæ©Ÿèƒ½è¦ä»¶

### 13.1 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

| é …ç›® | ç›®æ¨™ |
|------|------|
| ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚é–“ | 3ç§’ä»¥å†… |
| è¨˜éŒ²æ“ä½œãƒ¬ã‚¹ãƒãƒ³ã‚¹ | 1ç§’ä»¥å†…ï¼ˆä½“æ„Ÿå³æ™‚ï¼‰ |
| ç”»é¢é·ç§» | 0.5ç§’ä»¥å†… |

### 13.2 å¯ç”¨æ€§

| é …ç›® | ç›®æ¨™ |
|------|------|
| ã‚µãƒ¼ãƒ“ã‚¹ç¨¼åƒç‡ | 99%ä»¥ä¸Šï¼ˆFirebase SLAæº–æ‹ ï¼‰ |
| ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ | è¨˜éŒ²æ“ä½œã¯ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚‚å¯èƒ½ |

---

## 14. é–‹ç™ºãƒ»ãƒªãƒªãƒ¼ã‚¹æº–å‚™

### 14.1 å¿…è¦ãªæº–å‚™

| é …ç›® | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
|------|------------|
| Google Play Developerã‚¢ã‚«ã‚¦ãƒ³ãƒˆ | æœªå–å¾— |
| Firebase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ | âœ… å®Œäº† |
| ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ä½œæˆ | æœªç€æ‰‹ |
| ã‚¹ãƒˆã‚¢æ²è¼‰æƒ…å ±æº–å‚™ | æœªç€æ‰‹ |

### 14.2 ãƒªãƒªãƒ¼ã‚¹ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [x] å…¨ç”»é¢ã®å®Ÿè£…å®Œäº†
- [x] Firestore ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«é©ç”¨
- [x] ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥å‹•ä½œç¢ºèªï¼ˆâ€»Expo Goåˆ¶é™ã‚ã‚Šï¼‰
- [ ] ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œç¢ºèª
- [ ] ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼å…¬é–‹
- [ ] ã‚¹ãƒˆã‚¢æ²è¼‰æƒ…å ±å…¥åŠ›
- [ ] æœ¬ç•ªãƒ“ãƒ«ãƒ‰ï¼ˆEAS Buildï¼‰
- [ ] å†…éƒ¨ãƒ†ã‚¹ãƒˆé…å¸ƒ
- [ ] ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ»ãƒã‚°ä¿®æ­£
- [ ] æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹

---

## 15. æœªå®Ÿè£…æ©Ÿèƒ½ï¼ˆPhase 10ä»¥é™ã§æ¤œè¨ï¼‰

| æ©Ÿèƒ½ | èª¬æ˜ | å„ªå…ˆåº¦ |
|------|------|--------|
| users.statsæ›´æ–° | cheers_received/sent ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–° | ä¸­ |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ– | reactions.from_uidå½è£…é˜²æ­¢ | é«˜ |
| ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ– | sendReminders ã®å…¨ã‚«ãƒ¼ãƒ‰ã‚¹ã‚­ãƒ£ãƒ³æ”¹å–„ | ä½ |

---

## æ”¹è¨‚å±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜ | å¤‰æ›´å†…å®¹ |
|------------|------|----------|
| 0.1 | 2025-11-26 | åˆç‰ˆä½œæˆ |
| 0.2 | 2025-11-26 | UXãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ãƒ»è¡Œå‹•å¿ƒç†å­¦ã‚¢ãƒ‰ãƒã‚¤ã‚¶ãƒ¼ã®ãƒ¬ãƒãƒ¼ãƒˆã‚’åæ˜  |
| 1.0 | 2025-12-07 | Phase 7ã€œ9ã®å®Ÿè£…å†…å®¹ã‚’åæ˜ ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«æ‹¡å¼µã€AIã‚¨ãƒ¼ãƒ«æ©Ÿèƒ½ã€äººé–“ã‚¨ãƒ¼ãƒ«æ©Ÿèƒ½ã€ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€ãƒãƒƒã‚¸ã€ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ©Ÿèƒ½ã‚’è¿½åŠ ã€‚Cloud Functionsä¸€è¦§ã‚’æ›´æ–°ã€‚ |
