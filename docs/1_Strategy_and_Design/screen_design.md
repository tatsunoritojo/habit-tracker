# 画面遷移・ワイヤーフレーム設計書

## 基本情報

| 項目 | 内容 |
|------|------|
| ドキュメント種別 | 画面設計書 |
| バージョン | 1.0 |
| 作成日 | 2025年11月26日 |
| 最終更新 | 2025年12月7日 |
| 作成者 | プロジェクトマネージャー |

---

## 1. 画面一覧

| 画面ID | 画面名 | ファイル | 概要 |
|--------|--------|----------|------|
| S01 | スプラッシュ | app/index.tsx | 起動画面、初回判定 |
| S02 | オンボーディング | app/onboarding.tsx | 初回起動時の説明（3画面） |
| S03 | ホーム | app/(tabs)/home.tsx | カード一覧、今日の記録状況 |
| S04 | カード追加（L1選択） | app/add-card.tsx | カテゴリL1選択 |
| S04-2 | カード追加（L2/テンプレート） | app/select-card.tsx | サブカテゴリ・テンプレート選択 |
| S04-3 | オリジナルカード作成 | app/create-custom-card.tsx | カスタムカード作成 |
| S05 | カード詳細 | app/card-detail/[id].tsx | カレンダー表示、統計、バッジ |
| S05-2 | カード編集 | app/edit-card.tsx | タイトル・公開設定・リマインダー編集 |
| S06 | エール提案 | app/(tabs)/cheers.tsx | 他ユーザーへのエール送信 |
| S07 | 通知一覧 | app/(tabs)/notifications.tsx | 受け取ったエール一覧 |
| S08 | 設定 | app/(tabs)/settings.tsx | エール頻度、通知設定 |
| S08-2 | アカウント削除 | app/settings/account-deletion.tsx | 退会機能 |
| S09 | 今日のエール | app/today-cheers.tsx | まとめて通知タップ時の遷移先 |
| S10 | アーカイブ一覧 | app/archived-cards.tsx | アーカイブしたカードの管理 |
| S11 | お気に入り一覧 | app/favorites.tsx | お気に入りの仲間の管理（Phase 10-A） |

---

## 2. 画面遷移図

```
[S01 スプラッシュ]
    │
    ├─(初回)→ [S02 オンボーディング] → [S03 ホーム]
    │
    └─(2回目以降)→ [S03 ホーム]
                      │
                      ├→ [S05 カード詳細]
                      │    └→ [S05-2 カード編集]
                      │         ├→ [削除ダイアログ] → [ホーム]
                      │         └→ [アーカイブダイアログ] → [S10]
                      │
                      ├→ [S04 カード追加（L1選択）]
                      │    └→ [S04-2 L2/テンプレート選択]
                      │         ├→ [確認ダイアログ] → [ホーム]
                      │         └→ [S04-3 オリジナル作成] → [ホーム]
                      │
                      ├→ [S06 エール提案] ← タブ
                      │
                      ├→ [S07 通知一覧] ← タブ
                      │    └→ [S09 今日のエール]
                      │
                      ├→ [S08 設定] ← タブ
                      │    └→ [S08-2 アカウント削除]
                      │
                      └→ [S10 アーカイブ一覧]
                           └→ 復元 → [ホーム]
```

---

## 3. 各画面ワイヤーフレーム

### S01 スプラッシュ

```
┌────────────────────────────┐
│                            │
│                            │
│                            │
│                            │
│         [アプリロゴ]         │
│                            │
│         Habit Tracker      │
│                            │
│                            │
│                            │
│         [ローディング]       │
│                            │
└────────────────────────────┘
```

**仕様**
- 表示時間: 1〜2秒
- 裏で Firebase Anonymous Auth 実行
- AsyncStorageで初回/2回目以降を判定して遷移先を決定

---

### S02 オンボーディング（3画面）

#### S02-1: 小さな一歩

```
┌────────────────────────────┐
│                            │
│      [イラスト: 1タップ]     │
│                            │
│                            │
│      「小さな一歩」          │
│                            │
│    毎日の習慣を              │
│    タップひとつで記録。       │
│    それだけ。                │
│                            │
│                            │
│         ● ○ ○              │
│                            │
│      [次へ →]               │
│                            │
└────────────────────────────┘
```

#### S02-2: 仲間からのエール

```
┌────────────────────────────┐
│                            │
│      [イラスト: エール]      │
│                            │
│                            │
│    「仲間からのエール」       │
│                            │
│    💪⭐🤝                  │
│    文字を打たなくても        │
│    気持ちは伝わる。          │
│                            │
│                            │
│         ○ ● ○              │
│                            │
│      [次へ →]               │
│                            │
└────────────────────────────┘
```

#### S02-3: さあ、始めましょう

```
┌────────────────────────────┐
│                            │
│      [イラスト: 仲間]        │
│                            │
│                            │
│  「さあ、始めましょう」       │
│                            │
│    同じ習慣を続ける仲間と     │
│    ゆるく、軽く、繋がる。     │
│                            │
│                            │
│         ○ ○ ●              │
│                            │
│      [始める]               │
│                            │
└────────────────────────────┘
```

**仕様**
- スワイプまたはボタンで進む
- 「始める」タップで AsyncStorage にフラグ保存 → S03 ホームへ

---

### S03 ホーム

```
┌────────────────────────────┐
│ ≡                     🔔(2) │
├────────────────────────────┤
│                            │
│  今週 4日 / 今月 12日        │
│                            │
├────────────────────────────┤
│                            │
│  ┌────────────────────┐    │
│  │ 💪 毎朝ストレッチ     │    │
│  │                    │    │
│  │ 今日: ✔  連続: 7日   │    │
│  │ 💪💪⭐ (+1)         │    │
│  └────────────────────┘    │
│                            │
│  ┌────────────────────┐    │
│  │ 📚 英語学習         │    │
│  │                    │    │
│  │ 今日: □  連続: 3日   │    │
│  │ 🤝                  │    │
│  └────────────────────┘    │
│                            │
│  ┌────────────────────┐    │
│  │     ＋ カードを追加    │    │
│  └────────────────────┘    │
│                            │
├────────────────────────────┤
│ 🏠     💬     🔔     ⚙    │
│ホーム  エール  通知   設定   │
└────────────────────────────┘
```

**仕様**

| 要素 | 動作 |
|------|------|
| カードタップ（未記録） | 記録確認ダイアログ（記録する/統計のみ/キャンセル） |
| カードタップ（記録済） | S05 カード詳細へ |
| カード長押し | S05 カード詳細へ（記録スキップ） |
| ＋カードを追加 | S04 カード追加へ |
| ≡（ハンバーガー） | メニュー表示（アーカイブ、設定） |
| ナビゲーション | 各画面へ遷移 |

#### Welcome Back演出（3日以上空いた場合）

```
┌────────────────────────────┐
│                            │
│    🎉 おかえり！            │
│    5日ぶりに再開！          │
│    ここからまた一緒に        │
│    やっていこう。           │
│                            │
│    [紙吹雪アニメーション]    │
│                            │
│         [OK]               │
│                            │
└────────────────────────────┘
```

---

### S04 カード追加（L1選択）

```
┌────────────────────────────┐
│ ←              習慣を選ぶ   │
├────────────────────────────┤
│                            │
│  カテゴリを選んでください    │
│                            │
│  ┌────────────────────┐    │
│  │ 💪 健康             │    │
│  └────────────────────┘    │
│                            │
│  ┌────────────────────┐    │
│  │ 📚 学習             │    │
│  └────────────────────┘    │
│                            │
│  ┌────────────────────┐    │
│  │ 🏠 生活習慣          │    │
│  └────────────────────┘    │
│                            │
│  ┌────────────────────┐    │
│  │ 🎨 創作             │    │
│  └────────────────────┘    │
│                            │
│  ┌────────────────────┐    │
│  │ 🧘 マインドフルネス   │    │
│  └────────────────────┘    │
│                            │
├────────────────────────────┤
│  [✨ オリジナルを作成]       │
└────────────────────────────┘
```

---

### S04-2 サブカテゴリ・テンプレート選択

```
┌────────────────────────────┐
│ ←  健康                    │
├────────────────────────────┤
│                            │
│  ▼ 運動                    │
│  ┌────────────────────┐    │
│  │ 💪 毎日スクワット1回  │    │
│  └────────────────────┘    │
│  ┌────────────────────┐    │
│  │ 🏃 毎朝ストレッチ     │    │
│  └────────────────────┘    │
│                            │
│  ▼ 食事                    │
│  ┌────────────────────┐    │
│  │ 💧 水を1杯飲む       │    │
│  └────────────────────┘    │
│                            │
│  ▼ 睡眠                    │
│  ┌────────────────────┐    │
│  │ 🌙 23時に寝る準備    │    │
│  └────────────────────┘    │
│                            │
└────────────────────────────┘
```

---

### S04-3 オリジナルカード作成

```
┌────────────────────────────┐
│ ←      オリジナルを作成     │
├────────────────────────────┤
│                            │
│  ┌────────────────────┐    │
│  │ 習慣の名前を入力...    │    │
│  └────────────────────┘    │
│                            │
│  カテゴリを選んでください    │
│                            │
│  ▼ 学習                    │
│    ├─ 語学                 │
│    ├─ 読書                 │
│    └─ スキル ← 選択中       │
│                            │
│  ┌──────────────────┐      │
│  │ ☑ 公開する          │      │
│  └──────────────────┘      │
│                            │
│  [作成する]                 │
│                            │
└────────────────────────────┘
```

---

### S05 カード詳細

```
┌────────────────────────────┐
│ ←              毎朝ストレッチ │
├────────────────────────────┤
│                            │
│  ┌────────────────────┐    │
│  │   今月 15日 達成      │    │
│  │   先月より +3日       │    │
│  └────────────────────┘    │
│                            │
│  ┌────────────────────┐    │
│  │  連続: 8日           │    │
│  │  最長: 12日  エール: 24 │    │
│  └────────────────────┘    │
│                            │
├────────────────────────────┤
│  2025年12月                 │
│  日 月 火 水 木 金 土        │
│  ── ── ── ── ── ○ ○        │
│  ○ ○ ── ○ ○ ○ ○           │
│  ○ ○ ○ ○ ○ ○ ○            │
│  ○ ○ ○ ●                  │
│                            │
├────────────────────────────┤
│                            │
│  獲得バッジ                 │
│  🥉3日  🥈7日  ❤️‍🔥復活     │
│                            │
├────────────────────────────┤
│                            │
│  [✏️ 編集]                  │
│                            │
└────────────────────────────┘
```

**仕様**
- ○ = 達成日（アクセントカラー）
- ── = 未達成日（薄グレー、主張しない）
- ● = 今日
- 「編集」→ S05-2 カード編集へ

---

### S05-2 カード編集

```
┌────────────────────────────┐
│ ←              カード編集   │
├────────────────────────────┤
│                            │
│  タイトル                   │
│  ┌────────────────────┐    │
│  │ 毎朝ストレッチ        │    │
│  └────────────────────┘    │
│                            │
│  リマインダー               │
│  ┌────────────────────┐    │
│  │ ○ ON   ○ OFF        │    │
│  │ 時刻: 07:00          │    │
│  └────────────────────┘    │
│                            │
│  公開設定                   │
│  ┌────────────────────┐    │
│  │ ☑ 公開する           │    │
│  │  （仲間とエール交換）  │    │
│  └────────────────────┘    │
│                            │
│  [保存する]                 │
│                            │
├────────────────────────────┤
│                            │
│  [📦 アーカイブ]            │
│  [🗑️ 削除]                 │
│                            │
└────────────────────────────┘
```

---

### S06 エール提案

```
┌────────────────────────────┐
│            エールを送る      │
├────────────────────────────┤
│                            │
│  同じ習慣をがんばる仲間に     │
│  エールを送りませんか？       │
│                            │
├────────────────────────────┤
│                            │
│  ┌────────────────────┐    │
│  │ 筋トレ の仲間         │    │
│  │ 連続 12日 / 今週 5回   │    │
│  │                    │    │
│  │ 💪継続  ⭐すごい  🤝一緒 │    │
│  └────────────────────┘    │
│                            │
│  ┌────────────────────┐    │
│  │ 英語学習 の仲間        │    │
│  │ 連続 3日 / 今週 3回    │    │
│  │                    │    │
│  │ 💪継続  ⭐すごい  🤝一緒 │    │
│  └────────────────────┘    │
│                            │
│  ┌────────────────────┐    │
│  │ 読書 の仲間（再開！）   │    │
│  │ 4日ぶりに再開          │    │
│  │                    │    │
│  │ 💪継続  ⭐すごい  🤝一緒 │    │
│  └────────────────────┘    │
│                            │
│  [今日はスキップ]            │
│                            │
├────────────────────────────┤
│ 🏠     💬     🔔     ⚙    │
└────────────────────────────┘
```

**仕様**

| 要素 | 動作 |
|------|------|
| リアクションボタンタップ | 即送信 + アニメーション + アンドゥ表示 |
| 送信済み | ボタンがグレーアウト、「送信済み ✔」表示 |
| 「今日はスキップ」 | ホームへ戻る |
| 「再開！」ラベル | is_comeback=true のカードに表示 |

#### アンドゥスナックバー

```
┌────────────────────────────┐
│ 💪 ナイス継続 を送信しました [取り消す] │
└────────────────────────────┘
```

- 3秒で自動消去
- 「取り消す」タップで送信キャンセル

---

### S07 通知一覧

```
┌────────────────────────────┐
│            通知             │
├────────────────────────────┤
│                            │
│  今日                      │
│  ─────────────────────     │
│  💪 ナイス継続              │
│  「毎朝ストレッチ」にエール    │
│  10:23                     │
│                            │
│  ⭐ すごい！                │
│  「英語学習」に仲間から       │
│  07:15                     │
│                            │
│  昨日                      │
│  ─────────────────────     │
│  🤝 一緒にがんばろ           │
│  「読書」にエールが届きました  │
│  22:10                     │
│                            │
│  💪 ナイス継続              │
│  「毎朝ストレッチ」にエール    │
│  08:30                     │
│                            │
├────────────────────────────┤
│ 🏠     💬     🔔     ⚙    │
└────────────────────────────┘
```

**仕様**

| 要素 | 動作 |
|------|------|
| 通知アイテムタップ | S05 該当カード詳細へ |
| 未読通知 | 背景色でハイライト |
| 既読化 | 画面表示時に自動で既読処理 |

---

### S08 設定

```
┌────────────────────────────┐
│            設定             │
├────────────────────────────┤
│                            │
│  エール設定                 │
│  ─────────────────────     │
│  エール頻度                 │
│  [medium ▼]                │
│                            │
│  通知設定                   │
│  ─────────────────────     │
│  プッシュ通知               │
│  [ON ○]                    │
│                            │
│  通知モード                 │
│  [○リアルタイム ○まとめて]   │
│                            │
│  まとめて通知時刻            │
│  [12:00, 18:00, 22:00]      │
│                            │
│  お休みモード               │
│  [ON ○] 23:00 - 07:00      │
│                            │
│  アカウント                 │
│  ─────────────────────     │
│  ニックネーム（Phase 9.5）     │
│  ┌────────────────────┐    │
│  │ さわやかさん          │    │
│  └────────────────────┘    │
│  ↓ エールの送信者として表示されます │
│                            │
│  データのエクスポート         │
│  [>]                       │
│                            │
│  アカウント削除              │
│  [>]                       │
│                            │
│  アプリ情報                 │
│  ─────────────────────     │
│  プライバシーポリシー         │
│  [>]                       │
│                            │
│  利用規約                   │
│  [>]                       │
│                            │
│  バージョン: 1.0.0          │
│                            │
├────────────────────────────┤
│ 🏠     💬     🔔     ⚙    │
└────────────────────────────┘
```

---

### S08-2 アカウント削除

```
┌────────────────────────────┐
│ ←          アカウント削除   │
├────────────────────────────┤
│                            │
│  ⚠️ 注意                   │
│                            │
│  アカウントを削除すると、     │
│  以下のデータがすべて失われます │
│                            │
│  • すべての習慣カード        │
│  • すべての記録データ        │
│  • 受け取ったエール          │
│  • 獲得したバッジ            │
│                            │
│  この操作は取り消せません。    │
│                            │
│                            │
│  ┌────────────────────┐    │
│  │ 削除を確認するには     │    │
│  │ 「削除」と入力         │    │
│  │ [          ]         │    │
│  └────────────────────┘    │
│                            │
│  [アカウントを削除]          │
│                            │
└────────────────────────────┘
```

---

### S09 今日のエール

```
┌────────────────────────────┐
│ ←          今日のエール     │
├────────────────────────────┤
│                            │
│  今日届いたエール            │
│                            │
│  ┌────────────────────┐    │
│  │ ⭐ すごい！          │    │
│  │ 筋トレの仲間から       │    │
│  │ 「7日連続おめでとう」   │    │
│  │ 14:30               │    │
│  └────────────────────┘    │
│                            │
│  ┌────────────────────┐    │
│  │ 💪 ナイス継続         │    │
│  │ 読書の仲間から        │    │
│  │ 「今日もナイス継続」   │    │
│  │ 12:15               │    │
│  └────────────────────┘    │
│                            │
│  ┌────────────────────┐    │
│  │ 🤝 一緒にがんばろ      │    │
│  │ 英語学習の仲間から     │    │
│  │ 「一緒にがんばってるよ」 │    │
│  │ 09:45               │    │
│  └────────────────────┘    │
│                            │
└────────────────────────────┘
```

**仕様**
- まとめて通知タップ時の遷移先
- 今日受け取ったエールのみ表示
- 時刻順（新しい順）

---

### S10 アーカイブ一覧

```
┌────────────────────────────┐
│ ←          アーカイブ       │
├────────────────────────────┤
│                            │
│  アーカイブしたカード        │
│                            │
│  ┌────────────────────┐    │
│  │ 🏃 ジョギング         │    │
│  │ アーカイブ: 2025/11/20 │    │
│  │ 累計: 45回 最長: 14日  │    │
│  │                    │    │
│  │ [復元] [完全に削除]    │    │
│  └────────────────────┘    │
│                            │
│  ┌────────────────────┐    │
│  │ 📝 日記              │    │
│  │ アーカイブ: 2025/10/15 │    │
│  │ 累計: 30回 最長: 10日  │    │
│  │                    │    │
│  │ [復元] [完全に削除]    │    │
│  └────────────────────┘    │
│                            │
│  💡 アーカイブについて       │
│  アーカイブしたカードは      │
│  記録は残りますが、          │
│  ホーム画面には表示されません。 │
│                            │
└────────────────────────────┘
```

**仕様**
- 「復元」→ status を active に戻し、ホームに表示
- 「完全に削除」→ 確認ダイアログ後、カードとログを完全削除

---

## 4. 共通UIコンポーネント

### 4.1 ナビゲーションバー

```
┌────────────────────────────┐
│ 🏠     💬     🔔     ⚙    │
│ホーム  エール  通知   設定   │
└────────────────────────────┘
```

- 常時表示（スプラッシュ、オンボーディング除く）
- 選択中のアイコンはアクセントカラー
- 通知バッジ: 未読エール数を表示

### 4.2 カードコンポーネント

```
┌────────────────────────────┐
│ [アイコン] カードタイトル     │
│                            │
│ 今日: ✔/□  連続: N日        │
│ 💪💪⭐ (+N)                 │
└────────────────────────────┘
```

### 4.3 スナックバー（アンドゥ）

```
┌────────────────────────────┐
│ [アイコン] メッセージ  [取り消す] │
└────────────────────────────┘
```

- 画面下部に表示
- 3秒で自動消去
- 「取り消す」でアクション取り消し

### 4.4 トースト

```
┌────────────────────────────┐
│  ✔ メッセージ                │
└────────────────────────────┘
```

- 画面中央 or 下部に表示
- 1〜2秒で自動消去
- インタラクションなし

### 4.5 確認ダイアログ

```
┌────────────────────────────┐
│                            │
│    タイトル                 │
│    メッセージ               │
│                            │
│  [キャンセル]    [確認]     │
│                            │
└────────────────────────────┘
```

### 4.6 削除確認ダイアログ（DeleteCardDialog）

```
┌────────────────────────────┐
│                            │
│  ⚠️ カードを削除しますか？   │
│                            │
│  「毎朝ストレッチ」と         │
│  すべての記録が削除されます。  │
│                            │
│  💡 アーカイブなら記録を      │
│     残したまま非表示に        │
│     できます                 │
│                            │
│  [キャンセル]               │
│  [アーカイブにする]          │
│  [削除する]                 │
│                            │
└────────────────────────────┘
```

---

## 5. アニメーション・演出

### 5.1 記録完了時

- カードが軽くバウンス
- チェックマークがフェードイン
- 連続日数がカウントアップ

### 5.2 リアクション送信時

| type | アニメーション |
|------|---------------|
| cheer (💪) | カードが軽くバウンド |
| amazing (⭐) | 星が弾けるエフェクト |
| support (🤝) | カード同士が近づくモーション |

### 5.3 エール受信時（通知一覧）

- 新規エールはスライドインで表示
- リアクションアイコンが軽くバウンス

### 5.4 Welcome Back演出

- 紙吹雪アニメーション
- メッセージがフェードイン

### 5.5 バッジ獲得時

- バッジアイコンが拡大→縮小
- キラキラエフェクト

---

## 6. 画面遷移まとめ

| 遷移元 | アクション | 遷移先 |
|--------|------------|--------|
| S01 | 起動完了（初回） | S02 |
| S01 | 起動完了（2回目以降） | S03 |
| S02 | 「始める」タップ | S03 |
| S03 | カードタップ（未記録） | 記録ダイアログ |
| S03 | カードタップ（記録済） | S05 |
| S03 | 「+ カードを追加」 | S04 |
| S03 | ハンバーガー→アーカイブ | S10 |
| S03 | ナビ「エール」 | S06 |
| S03 | ナビ「通知」 | S07 |
| S03 | ナビ「設定」 | S08 |
| S04 | カテゴリタップ | S04-2 |
| S04 | 「オリジナルを作成」 | S04-3 |
| S04-2 | テンプレート選択→「始める」 | S03 |
| S04-3 | 「作成する」 | S03 |
| S05 | 「編集」 | S05-2 |
| S05-2 | 「アーカイブ」 | S10 |
| S05-2 | 「削除」 | 削除ダイアログ → S03 |
| S06 | リアクション送信完了 | S06（そのまま） |
| S06 | 「今日はスキップ」 | S03 |
| S07 | 通知アイテムタップ | S05 |
| S07 | まとめて通知からの遷移 | S09 |
| S08 | 「アカウント削除」 | S08-2 |
| S10 | 「復元」 | S03 |
| S10 | 「完全に削除」 | 削除ダイアログ → S10 |

---

## 改訂履歴

| バージョン | 日付 | 変更内容 |
|------------|------|----------|
| 0.1 | 2025-11-26 | 初版作成 |
| 1.0 | 2025-12-07 | Phase 7〜9の実装内容を反映。S04-2/S04-3/S05-2/S06/S08-2/S09/S10を追加。エール提案画面、アーカイブ機能、オンボーディング、Welcome Back演出、バッジ表示を追加。 |
| 1.1 | 2025-12-08 | Phase 9.5の実装内容を反映。S08（設定）にニックネーム編集UIを追加。 |
