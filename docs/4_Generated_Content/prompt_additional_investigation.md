# 追加調査依頼：仕様書更新の補足情報

## 背景

先ほど提出いただいた「実装現状レポート」は非常に高品質でした。ありがとうございます。

仕様書を最終化するにあたり、以下の追加調査をお願いします。

---

## 調査項目

### 1. 不明ファイルの確認

**対象ファイル:** `app/today-cheers.tsx`

レポートで「用途不明」と記載されていました。以下を確認してください。

- このファイルの役割は何か？
- 現在使用されているか？（他ファイルからの参照有無）
- 削除しても問題ないか？

**出力形式:**
```
ファイル: app/today-cheers.tsx
役割: （記載）
使用状況: 使用中 / 未使用
判断: 削除可 / 残す必要あり
理由: （記載）
```

---

### 2. AIエール文言の詳細

**対象ファイル:** `functions/src/services/cheerService.ts`（または文言が定義されているファイル）

レポートでは「68種類のエール文言」と記載がありましたが、具体的な内容が不明でした。

以下を抽出してください。

- 文言の全リスト（または代表的なサンプル20件程度）
- `reason` × `reactionType` の組み合わせ方法
- 文言選択のロジック（ランダム？重複回避？）

**出力形式:**
```
## AIエール文言

### パターン①: 記録直後 (reason: 'record')
| reactionType | 文言例 |
|--------------|--------|
| cheer | 「今日も記録お疲れさま！💪」 |
| amazing | 「素晴らしい継続力！⭐」 |
| support | 「一緒に頑張ってるよ！🤝」 |

（他のパターンも同様に）

### 文言選択ロジック
（記載）
```

---

### 3. マッチングプール更新ロジックの詳細

**対象ファイル:** `functions/src/services/updateMatchingPools.ts`

レポートでは「推測」と記載されていた部分があります。正確な実装を確認してください。

- マッチングプールに含めるカードの条件
- 除外条件（非公開、非アクティブ等）
- `is_comeback` フラグの判定ロジック
- プール更新の具体的な処理フロー

**出力形式:**
```
## マッチングプール更新ロジック

### 対象カードの条件
- 条件1: ...
- 条件2: ...

### 除外条件
- 条件1: ...
- 条件2: ...

### is_comeback 判定
（記載）

### 処理フロー
1. ...
2. ...
3. ...
```

---

### 4. ユーザー統計の更新タイミング

**対象:** `users.stats` の `cheers_received`, `cheers_sent` フィールド

レポートで「更新トリガーが見当たらない」と記載がありました。

- これらのフィールドはどこで更新されるか？
- 更新されていない場合、未実装なのか、別の方法で計算しているのか？

**出力形式:**
```
## ユーザー統計更新

### cheers_received
更新タイミング: （記載）
更新箇所: （ファイル名と関数名）

### cheers_sent
更新タイミング: （記載）
更新箇所: （ファイル名と関数名）

### 未実装の場合
（理由や今後の対応を記載）
```

---

## 成果物

上記4項目の調査結果を「追加調査レポート」として提出してください。

フォーマットは自由ですが、上記の出力形式を参考にしてください。

---

## 優先度

| 項目 | 優先度 | 理由 |
|------|--------|------|
| 1. 不明ファイル確認 | 高 | 不要ファイルは仕様書に含めない |
| 2. AIエール文言 | 高 | 仕様書の品質に直結 |
| 3. マッチングロジック | 中 | 正確な仕様記載のため |
| 4. ユーザー統計 | 低 | 未実装の可能性あり、Phase 10で検討 |

---

よろしくお願いします。
