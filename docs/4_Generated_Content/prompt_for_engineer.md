# 仕様書更新のための実装現状レポート作成依頼

## あなたの役割

あなたは習慣継続×軽量SNSアプリ「Habit Tracker」の優秀なエンジニアです。

現在、プロジェクトの仕様書が古い状態（Phase 6時点）で止まっており、Phase 7〜9で実装された機能が反映されていません。

あなたの任務は、**ローカルのコードベースをリバースエンジニアリングし、実装の現状を正確に把握したレポートを作成すること**です。

---

## 背景情報

### プロジェクト概要

- **アプリ名**: Habit Tracker（習慣継続×軽量SNSアプリ）
- **コアコンセプト**: 「繋がりすぎない繋がり」
- **技術スタック**: React Native + Expo / Firebase (Auth, Firestore, Functions, FCM)

### 実装済みフェーズ

| Phase | 内容 | 状態 |
|-------|------|------|
| 1〜6 | MVPコア機能（カード作成、記録、カレンダー等） | ✅ 完了・仕様書あり |
| 7 | AIエール機能（専属ボット） | ✅ 完了・**仕様書なし** |
| 8 | 人間エール機能（マッチング） | ✅ 完了・**仕様書なし** |
| 9 | アプリ完成（UX改善、オンボーディング等） | ✅ 完了・**仕様書なし** |

---

## 作業依頼

### 1. 以下のファイルを読んでください

プロジェクトディレクトリに以下のドキュメントがあります。まず、これらを読んで背景を把握してください。

1. **設計意図ドキュメント** (`design_intent_document.md`)
   - 各機能の「なぜそう設計したか」が記載されています
   - コードを読む際の参考にしてください

2. **リバースエンジニアリング指示書** (`reverse_engineering_instructions.md`)
   - 抽出してほしい情報の詳細が記載されています
   - 出力フォーマットも指定されています

### 2. コードベースを解析してください

以下のディレクトリ・ファイルを解析し、現在の実装状況を把握してください。

```
habit-tracker/
├── app/                    # 画面コンポーネント
├── src/
│   ├── types/              # TypeScript型定義
│   ├── services/           # ビジネスロジック
│   ├── hooks/              # カスタムフック
│   ├── utils/              # ユーティリティ関数
│   └── components/         # 共通コンポーネント
├── functions/              # Cloud Functions
├── firestore.rules         # セキュリティルール
├── package.json            # 依存関係
└── app.json                # Expo設定
```

### 3. 実装現状レポートを作成してください

以下のフォーマットで「実装現状レポート」を作成してください。

---

## 出力フォーマット

```markdown
# 実装現状レポート

## 作成情報
- 作成日: YYYY-MM-DD
- 作成者: エンジニア名
- 対象: habit-tracker コードベース

---

## 1. データモデル（Firestoreコレクション）

### 1.1 users
```typescript
interface User {
  // フィールドを記載
}
```

### 1.2 cards
```typescript
interface Card {
  // フィールドを記載
}
```

（他のコレクションも同様に）

---

## 2. 画面一覧

| ファイルパス | 画面名 | 役割 |
|--------------|--------|------|
| app/index.tsx | スプラッシュ | 初回起動判定、ルーティング |
| app/onboarding.tsx | オンボーディング | 初回説明（3画面） |
| ... | ... | ... |

---

## 3. 画面遷移図

```
[スプラッシュ]
    │
    ├─(初回)→ [オンボーディング] → [カード追加]
    │
    └─(2回目以降)→ [ホーム]
                      │
                      ├→ [カード詳細]
                      ├→ [カード追加]
                      ├→ [エール提案]
                      ├→ [通知一覧]
                      ├→ [設定]
                      └→ [アーカイブ一覧]
```

---

## 4. Cloud Functions

| 関数名 | トリガー | 処理概要 |
|--------|----------|----------|
| onLogCreated | Firestore onCreate (logs) | ストリーク計算、AIエールスケジュール |
| ... | ... | ... |

---

## 5. ビジネスロジック

### 5.1 ストリーク計算
- ファイル: `src/services/logService.ts`
- ロジック概要: ...

### 5.2 マッチングロジック
- ファイル: `src/services/matchingService.ts`
- ロジック概要: ...

### 5.3 バッジ付与
- ファイル: `src/utils/gamification.ts`
- 条件一覧:
  | バッジ | 条件 |
  |--------|------|
  | 🥉 | 3日連続 |
  | ... | ... |

---

## 6. コンポーネント一覧

| コンポーネント | ファイル | 用途 |
|----------------|----------|------|
| Calendar | src/components/Calendar.tsx | カレンダー表示 |
| DeleteCardDialog | src/components/DeleteCardDialog.tsx | 削除確認ダイアログ |
| ... | ... | ... |

---

## 7. 外部依存

### 7.1 主要パッケージ
| パッケージ | バージョン | 用途 |
|------------|------------|------|
| expo | x.x.x | フレームワーク |
| firebase | x.x.x | バックエンド |
| ... | ... | ... |

### 7.2 Firebase設定
- 使用サービス: Auth, Firestore, Functions, FCM

---

## 8. Firestoreセキュリティルール

```javascript
// firestore.rules の内容を転記
```

---

## 9. 特記事項

### 9.1 仕様書との乖離
（コードを読んで気づいた、仕様書に記載がなさそうな機能や変更点）

### 9.2 改善提案
（コードレビュー中に気づいた改善点があれば）

### 9.3 不明点
（コードの意図が不明な箇所があれば、「？」付きで記載）
```

---

## 注意事項

1. **型定義ファイルを優先的に確認**
   - `src/types/index.ts` に主要な型定義があるはずです

2. **コメントも記録**
   - コード内に意図が書かれている場合は転記してください

3. **不明点は「？」で記録**
   - 後でPMと確認しますので、推測で埋めずに「？」を付けてください

4. **網羅性を重視**
   - 抜け漏れがあると仕様書に反映できないため、できる限り網羅的に抽出してください

---

## 成果物

作成した「実装現状レポート」を提出してください。

PMがこのレポートと「設計意図ドキュメント」を統合し、最終的な仕様書を更新します。

---

## 質問がある場合

作業中に不明点があれば、PMに確認してください。

特に以下の判断が難しい場合は確認をお願いします：
- 「これは意図的な実装か、暫定対応か」
- 「この機能は仕様書に含めるべきか」
- 「この命名・構造は正式なものか」
