# プロジェクト開発分析マニュアル

このマニュアルは、`habit-tracker`プロジェクトの定期的な開発分析を実施するためのガイドです。後任のデータアナリストが同様の観点からプロジェクトの健全性と開発状況を評価し、その記録を残せるようにすることを目的としています。

---

## 1. 分析の目的

*   プロジェクトのコードベースの構造、規模、複雑性を理解する。
*   開発リズムと作業負荷の傾向を把握する。
*   コード品質、保守性、潜在的なリスク領域を特定する。
*   定期的な分析結果を記録し、意思決定の根拠とする。

## 2. 分析実施手順

分析は以下のステップで構成されます。各ステップで必要なコマンドと、出力されるドキュメントを記録します。

### ステップ 0: 環境準備

*   分析対象のプロジェクトリポジトリをクローンし、最新の状態に更新します。
*   適切なシェル環境（PowerShell推奨）で作業を行います。

### ステップ 1: スクリプト役割分析とドキュメント作成

プロジェクト内の主要なスクリプトファイル（`.ts`, `.tsx`）を特定し、それぞれの役割と責務を詳細に記述します。

1.  **対象ファイルの特定**:
    *   `glob`ツールや`git log --name-only`などを使用して、プロジェクト内の`.ts`および`.tsx`ファイルをリストアップします。
    *   `node_modules`やビルド成果物などの除外対象を考慮します。

2.  **ファイル内容の分析**:
    *   各ファイルのコードを読み込み、そのインポート/エクスポート、主要な関数/クラス、UIコンポーネント、ビジネスロジックなどを理解します。
    *   特に、`src/types/index.ts`のような型定義ファイルからデータモデルを把握します。

3.  **ドキュメントの作成**:
    *   分析結果を `script_roles.md` としてまとめます。
    *   **ファイル名**: `script_roles.md` (例: `docs/analysis_reports/YYYY-MM-DD/script_roles.md`)
    *   **内容**: 各ファイルパス、その役割、簡単な説明をMarkdownテーブル形式で記述します。

### ステップ 2: コード行数 (LOC) 分析

特定された各スクリプトファイルの物理的なコード行数を計測し、全体およびモジュールごとの統計を報告します。

1.  **LOCの計測**:
    *   各ファイルに対し、以下のPowerShellコマンドを実行して行数を取得します。
        ```powershell
        (Get-Content -LiteralPath "path/to/your/file.tsx").Length
        ```
    *   特殊文字（例: `[id].tsx`）を含むファイルパスには `-LiteralPath` を必ず使用してください。

2.  **統計レポートの作成**:
    *   計測結果を集計し、`loc_statistics.md` としてレポートを作成します。
    *   **ファイル名**: `loc_statistics.md` (例: `docs/analysis_reports/YYYY-MM-DD/loc_statistics.md`)
    *   **内容**:
        *   総コード行数。
        *   `app`, `src`, `functions` など主要モジュールごとのLOCと割合。
        *   `src`モジュール内のサブモジュール（`hooks`, `services`, `components`など）ごとのLOCと割合。
        *   各ファイルのLOC詳細リスト。

### ステップ 3: 開発リズムと作業負荷分析 (コミット履歴)

`git` のコミット履歴から、開発の活動状況、コードの変更量（コードチャーン）、および開発パターンを分析します。

1.  **コミット頻度**:
    *   全てのコミットの作成日時を取得し、日付ごとのコミット数を集計します。
    ```powershell
    git log --pretty=format:"%ad" --date=short
    ```
    *   結果から、開発が集中した期間やリリースサイクルなどを把握します。

2.  **コードチャーン分析**:
    *   各コミットで追加および削除された行数を確認します。
    ```powershell
    git log --stat
    ```
    *   `git log --numstat` も詳細な数値情報を提供します。
    *   特に大きな追加/削除があったコミットに注目し、その内容とプロジェクトへの影響を考察します。リファクタリングが活発か、新規開発が主かを評価します。

### ステップ 4: テストカバレッジ分析

プロジェクトに自動テストが導入されているか、その範囲と品質を評価します。

1.  **テストインフラの確認**:
    *   `package.json` を開き、`scripts` セクションに `test` コマンドが存在するか確認します。
    *   `dependencies` および `devDependencies` から `jest`, `react-native-testing-library` などのテスト関連ライブラリがインストールされているかを確認します。

2.  **カバレッジの計測（可能な場合）**:
    *   テストが設定されている場合、カバレッジ計測コマンド（例: `npm test -- --coverage`）を実行します。
    *   カバレッジレポートを確認し、コードベースのテスト網羅度を評価します。

3.  **分析結果の考察**:
    *   テストが存在しない場合は、そのリスク（リグレッション、保守性の低下）を明確に記述します。
    *   テストが存在する場合は、カバレッジの数値と、それが品質保証にどのように貢献しているかを評価します。

### ステップ 5: ファイル変更頻度分析 (ホットスポット)

プロジェクト内で最も頻繁に変更されているファイルを特定し、その理由と潜在的な影響を考察します。

1.  **変更頻度の計測**:
    *   以下のPowerShellコマンドを実行し、ファイルごとの変更回数を取得します。
    ```powershell
    git log --pretty=format: --name-only | Where-Object { $_ } | Group-Object | Sort-Object -Property Count -Descending
    ```
    *   `--name-only` オプションは変更されたファイル名のみを出力します。
    *   `Where-Object { $_ }` は空行を除去します。
    *   `Group-Object` はファイル名をグループ化し、`Count` プロパティに行数を与えます。
    *   `Sort-Object -Property Count -Descending` は変更回数が多い順にソートします。

2.  **ホットスポットの特定と考察**:
    *   上位のファイルに注目し、なぜそれらが頻繁に変更されているのか（例: コアなビジネスロジック、複雑なUI、頻繁な要件変更）を分析します。
    *   変更頻度が高いことが、設計上の課題や開発プロセスの改善点を示唆していないかを検討します。

### ステップ 6: 最終レポートの作成

上記全ての分析結果を統合し、プロジェクトの全体像を把握できる包括的なレポートを作成します。

1.  **レポートの構成**:
    *   **総括**: 分析結果のハイライトと最も重要な結論（例: 迅速な開発、テストの欠如）。
    *   **コード規模分析**: LOCの統計と主要モジュールの特徴。
    *   **開発リズムと作業負荷分析**: コミット頻度、コードチャーン、開発パターンの考察。
    *   **コード品質と保守性分析**: ホットスポット、テストの有無とその影響、潜在的なリスク。
    *   **推奨事項**: プロジェクトの改善に向けた具体的な提案（例: テスト導入、CI/CDの強化）。

2.  **ファイル名**: `overall_report.md` (例: `docs/analysis_reports/YYYY-MM-DD/overall_report.md`)

## 3. レポートの記録

すべての分析ドキュメント（`script_roles.md`, `loc_statistics.md`, `overall_report.md`）は、日付ごとのディレクトリ（例: `docs/analysis_reports/2025-11-28/`）に配置し、Gitリポジトリにコミットします。

```bash
# 例: 2025年11月28日のレポートの場合
mkdir docs/analysis_reports/2025-11-28
mv script_roles.md docs/analysis_reports/2025-11-28/
mv loc_statistics.md docs/analysis_reports/2025-11-28/
mv overall_report.md docs/analysis_reports/2025-11-28/

# Gitに追加しコミット
git add docs/analysis_reports/2025-11-28/
git commit -m "docs: Add 2025-11-28 development analysis report"
```
---
