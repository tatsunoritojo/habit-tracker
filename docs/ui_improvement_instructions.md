# UI改善指示書

## 基本情報

| 項目 | 内容 |
|------|------|
| ドキュメント種別 | 作業指示書 |
| 作成日 | 2025年12月19日 |
| 作成者 | プロジェクトマネージャー (Claude PM) |
| 対象 | フロントエンドエンジニア |
| 対象アプリ | Habit Tracker（習慣継続×軽量SNSアプリ） |

---

## 1. 背景・目的

### 1.1 背景

内部テスト段階でUI/UXの問題点が発見されました。主に以下の3カテゴリに分類されます。

1. **技術的バグ**: Expo Routerのヘッダー設定が不適切で、開発用の文字列がそのまま表示されている
2. **設計意図との乖離**: 仕様書の設計と実装が一部異なっている
3. **UX改善余地**: ユーザー体験をより良くするための調整

### 1.2 目的

- ユーザーに違和感を与える技術的な表示を解消する
- 仕様書に基づいた一貫性のあるUIを実現する
- 本番リリース（Phase 10）に向けた品質向上

### 1.3 作業者への補足

本指示書は**修正方針**を示すものです。具体的な実装方法については作業者の裁量に委ねます。

また、作業中に本指示書に記載のない問題を発見した場合や、より良い実装方法がある場合は、**現場判断で対応して構いません**。ただし、設計意図（セクション5参照）に反しない範囲でお願いします。

判断に迷う場合はプロジェクトマネージャーに確認してください。

---

## 2. 改善項目一覧

### 2.1 優先度の定義

| 優先度 | 意味 | 対応期限 |
|--------|------|----------|
| 🔴 高 | 技術的バグ、ユーザーに明らかな違和感を与える | 即時対応 |
| 🟠 中 | 設計意図との乖離、UX上の問題 | 本番リリース前に対応 |
| 🟡 低 | あると良い改善、デザイン調整 | 余裕があれば対応 |

### 2.2 全項目サマリー

| # | 優先度 | 画面 | 問題概要 |
|---|--------|------|----------|
| 1 | 🔴 | 全タブ画面 | 「(tabs)」がヘッダーに表示 |
| 2 | 🔴 | カード詳細 | 「card-detail/[id]」がヘッダーに表示 |
| 3 | 🔴 | アーカイブ一覧 | 「archived-cards」がヘッダーに表示 |
| 4 | 🔴 | カード詳細/アーカイブ | 戻るボタン（←）が2つ重複表示 |
| 5 | 🟠 | ホーム | エール送信元が「from ハビットシステム」 |
| 6 | 🟠 | エール画面 | カテゴリに「（その他）」が表示 |
| 7 | 🟠 | 通知一覧 | 送信者がニックネームではなく汎用表現 |
| 8 | 🟠 | 通知一覧 | カード名が「習慣カード」という汎用名 |
| 9 | 🟠 | 通知一覧 | 日付形式が混在 |
| 10 | 🟠 | 通知一覧 | アイコンが全て同じ緑丸 |
| 11 | 🟠 | アーカイブ一覧 | 「作成日」と表示（正しくは「アーカイブ日」） |
| 12 | 🟠 | アーカイブ一覧 | 統計情報が表示されていない |
| 13 | 🟡 | ホーム | カードアイコンが全て📝 |
| 14 | 🟡 | ホーム | 統計エリアの視覚的インパクトが弱い |
| 15 | 🟡 | 設定 | ユーザーIDが生で表示 |
| 16 | 🟡 | 設定 | まとめて通知のデフォルト時刻が不適切 |
| 17 | 🟡 | 設定 | お休みモードのデフォルト時間が不適切 |
| 18 | 🟡 | カード詳細 | バッジ未獲得時の表示が改善余地あり |

---

## 3. 各項目の詳細指示

### 🔴 優先度：高

#### #1 全タブ画面：「(tabs)」表示の解消

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/(tabs)/_layout.tsx` |
| 現状 | 全てのタブ画面（ホーム、エール、通知、設定）の左上に「(tabs)」と表示される |
| 原因 | Expo Routerのタブレイアウトでヘッダー設定が未指定 |
| 改善内容 | タブレイアウトのヘッダーを非表示にする |
| 完了条件 | 全タブ画面で「(tabs)」が表示されないこと |

#### #2 カード詳細：「card-detail/[id]」表示の解消

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/card-detail/[id].tsx` または `app/_layout.tsx` |
| 現状 | カード詳細画面のヘッダーに「card-detail/[id]」と表示される |
| 原因 | Expo Routerのデフォルトヘッダーが表示されている |
| 改善内容 | ルートレベルのヘッダーを非表示にする |
| 完了条件 | 「card-detail/[id]」が表示されず、「カード詳細」のみ表示されること |

#### #3 アーカイブ一覧：「archived-cards」表示の解消

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/archived-cards.tsx` または `app/_layout.tsx` |
| 現状 | アーカイブ一覧画面のヘッダーに「archived-cards」と表示される |
| 原因 | 同上 |
| 改善内容 | ルートレベルのヘッダーを非表示にする |
| 完了条件 | 「archived-cards」が表示されず、「アーカイブ一覧」のみ表示されること |

#### #4 戻るボタン重複の解消

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/card-detail/[id].tsx`, `app/archived-cards.tsx`, `app/_layout.tsx` |
| 現状 | カード詳細・アーカイブ一覧画面で「←」ボタンが2つ表示される |
| 原因 | Expo Routerのデフォルトヘッダーとカスタムヘッダーが両方表示 |
| 改善内容 | Expo Routerのデフォルトヘッダーを非表示にし、カスタムヘッダーのみ使用 |
| 完了条件 | 戻るボタンが1つのみ表示されること |

---

### 🟠 優先度：中

#### #5 ホーム：エール送信元の表記変更

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/(tabs)/home.tsx` またはカードコンポーネント |
| 現状 | 「エール: ⭐ from ハビットシステム」と表示 |
| 改善内容 | 「from 応援ボット」に変更 |
| 補足 | システムからのエールであることはわかるように、ただし親しみやすい表現に |
| 完了条件 | 「from 応援ボット」と表示されること |

#### #6 エール画面：「（その他）」表示の改善

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/(tabs)/cheers.tsx` |
| 現状 | 「筋トレ（その他）の仲間」と表示 |
| 改善内容 | 「（その他）」を非表示にする、または「筋トレ仲間」のように簡略化 |
| 完了条件 | 「（その他）」が表示されないこと |

#### #7 通知一覧：送信者のニックネーム表示

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/(tabs)/notifications.tsx` |
| 現状 | 「ハビット仲間」「習慣の仲間」など汎用表現が混在 |
| 改善内容 | 送信者のニックネームを表示する（例：「たっちゃんさん」） |
| 補足 | エール画面と表示を統一する方針。システムからのエールは「応援ボット」と表示 |
| 完了条件 | 人間からのエール → ニックネーム表示、システムからのエール → 「応援ボット」表示 |

#### #8 通知一覧：実際のカード名を表示

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/(tabs)/notifications.tsx` |
| 現状 | 「習慣カード」という汎用名で表示 |
| 改善内容 | 実際のカード名を表示（例：「毎朝ストレッチ」） |
| データソース | `reactions` コレクションの `card_title` フィールド、または `to_card_id` から取得 |
| 完了条件 | 各通知に実際のカード名が表示されること |

#### #9 通知一覧：日付形式の統一

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/(tabs)/notifications.tsx` |
| 現状 | 「5日前」「12/8」など形式が混在 |
| 改善内容 | ルールを統一（推奨：7日以内は相対表示「○日前」「○時間前」、8日以上は日付「12/8」） |
| 完了条件 | 全ての日付が統一されたルールで表示されること |

#### #10 通知一覧：アイコンの改善

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/(tabs)/notifications.tsx` |
| 現状 | 全て同じ緑丸アイコン |
| 改善内容 | リアクションアイコン（💪⭐🤝）またはカテゴリアイコンを表示 |
| 推奨 | リアクションアイコンの方が直感的 |
| 完了条件 | 通知の種類に応じたアイコンが表示されること |

#### #11 アーカイブ一覧：日付ラベルの修正

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/archived-cards.tsx` |
| 現状 | 「作成日: 2025/12/8」と表示 |
| 改善内容 | 「アーカイブ日: 2025/12/8」に変更 |
| データソース | `cards` コレクションの `archived_at` フィールド |
| 完了条件 | 「アーカイブ日」と表示されること |

#### #12 アーカイブ一覧：統計情報の追加

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/archived-cards.tsx` |
| 現状 | 日付のみ表示 |
| 改善内容 | 「累計○回達成」「最長○日連続」を追加表示 |
| データソース | `cards` コレクションの `total_logs`, `longest_streak` フィールド |
| 設計意図 | アーカイブは「達成の記録を振り返る場所」という位置づけ |
| 完了条件 | 各アーカイブカードに統計情報が表示されること |

---

### 🟡 優先度：低

#### #13 ホーム：カテゴリ別アイコン表示

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/(tabs)/home.tsx` またはカードコンポーネント |
| 現状 | 全てのカードが📝アイコン |
| 改善内容 | カテゴリL1に応じたアイコンを表示 |
| アイコン対応 | 健康:💪、学習:📚、生活習慣:🏠、創作:🎨、マインドフルネス:🧘 |
| 完了条件 | カテゴリに応じたアイコンが表示されること |

#### #14 ホーム：統計エリアの視覚強化

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/(tabs)/home.tsx` |
| 現状 | 「今週 0日 / 今月 4日」がシンプルなテキスト |
| 改善内容 | 数字を大きく、達成がある場合は色を付けるなど視覚的強調 |
| 補足 | 作業者の裁量でデザイン判断可 |
| 完了条件 | 統計が目立つようになっていること |

#### #15 設定：ユーザーID表示の改善

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/(tabs)/settings.tsx` |
| 現状 | 生のFirebase UID（例：KY9p49QaxjWNt0ng1zjRUb0ECJW2）が表示 |
| 改善内容 | 非表示にする、または「サポート用ID」として折りたたみ表示 |
| 補足 | 一般ユーザーには意味がなく、不安を与える可能性がある |
| 完了条件 | UIDが目立たなくなっていること |

#### #16 設定：まとめて通知のデフォルト時刻修正

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/(tabs)/settings.tsx` または初期値設定箇所 |
| 現状 | 02:34, 10:34, 20:34 など中途半端な時刻 |
| 改善内容 | 仕様通り 12:00, 18:00, 22:00 に修正 |
| 補足 | これはテスト時の設定が残っている可能性。デフォルト値の確認 |
| 完了条件 | 新規ユーザーのデフォルト値が 12:00, 18:00, 22:00 であること |

#### #17 設定：お休みモードのデフォルト時間修正

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/(tabs)/settings.tsx` または初期値設定箇所 |
| 現状 | 02:00〜23:00 |
| 改善内容 | 仕様通り 23:00〜07:00 に修正 |
| 完了条件 | 新規ユーザーのデフォルト値が 23:00〜07:00 であること |

#### #18 カード詳細：バッジ未獲得表示の改善

| 項目 | 内容 |
|------|------|
| 対象ファイル | `app/card-detail/[id].tsx` |
| 現状 | 未獲得バッジはロックアイコン（🔒）のみ |
| 改善内容 | グレーアウト表示＋獲得条件の表示（例：「あと2日で獲得」）を検討 |
| 補足 | 作業者の裁量で判断可。現状維持でも可 |
| 完了条件 | 改善された場合、獲得条件がわかりやすくなっていること |

---

## 4. 修正対象ファイル一覧

作業効率のため、ファイル単位でまとめた一覧です。

| ファイル | 対応項目 | 優先度 |
|----------|----------|--------|
| `app/(tabs)/_layout.tsx` | #1 | 🔴 |
| `app/_layout.tsx` | #2, #3, #4 | 🔴 |
| `app/card-detail/[id].tsx` | #2, #4, #18 | 🔴🟡 |
| `app/archived-cards.tsx` | #3, #4, #11, #12 | 🔴🟠 |
| `app/(tabs)/home.tsx` | #5, #13, #14 | 🟠🟡 |
| `app/(tabs)/cheers.tsx` | #6 | 🟠 |
| `app/(tabs)/notifications.tsx` | #7, #8, #9, #10 | 🟠 |
| `app/(tabs)/settings.tsx` | #15, #16, #17 | 🟡 |

---

## 5. 設計意図の補足

作業中に判断が必要な場合の参考情報です。

### 5.1 ニックネーム表示について

Phase 9.5でニックネーム機能が追加され、エール送信者の表示方針が更新されました。

| 画面 | 表示内容 |
|------|----------|
| エール画面 | ニックネーム + カテゴリ（例：「たっちゃん2 / 筋トレ仲間」） |
| 通知一覧 | ニックネーム（例：「たっちゃんさんからエール」） |
| ホーム（システムエール） | 「from 応援ボット」 |

### 5.2 「繋がりすぎない繋がり」の原則

このアプリのコアコンセプトは「繋がりすぎない繋がり」です。以下の原則を維持してください。

- テキストコミュニケーションは排除（リアクションのみ）
- ユーザー同士が直接やり取りする機能は作らない
- 「誰かと頑張っている感」を提供するが、SNS疲れを起こさない

### 5.3 ポジティブ体験の設計

- 失敗を責めない（ストリーク途切れを強調しない）
- 再開を称える（復活バッジ、Welcome Back演出）
- 通知文言はポジティブに（NGワード：「まだ」「サボり」「失われます」）

---

## 6. 確認方法（チェックリスト）

修正完了後、以下を確認してください。

### 6.1 優先度高（必須確認）

- [ ] 全タブ画面で「(tabs)」が表示されない
- [ ] カード詳細画面で「card-detail/[id]」が表示されない
- [ ] アーカイブ一覧で「archived-cards」が表示されない
- [ ] 戻るボタンが重複していない

### 6.2 優先度中

- [ ] ホームのエール表示が「from 応援ボット」になっている
- [ ] エール画面で「（その他）」が表示されない
- [ ] 通知一覧でニックネームが表示される
- [ ] 通知一覧で実際のカード名が表示される
- [ ] 通知一覧の日付形式が統一されている
- [ ] 通知一覧のアイコンがリアクションに対応している
- [ ] アーカイブ一覧で「アーカイブ日」と表示される
- [ ] アーカイブ一覧で統計情報が表示される

### 6.3 優先度低

- [ ] ホームのカードにカテゴリ別アイコンが表示される
- [ ] ホームの統計エリアが視覚的に強調されている
- [ ] 設定でユーザーIDが目立たない
- [ ] まとめて通知のデフォルトが 12:00/18:00/22:00
- [ ] お休みモードのデフォルトが 23:00〜07:00

---

## 7. 質問・確認先

作業中に不明点がある場合は、プロジェクトマネージャー（Claude PM）に確認してください。

特に以下の場合は事前確認を推奨します。

- 設計意図（セクション5）に反する可能性がある変更
- 本指示書に記載のない大きな変更
- データモデルの変更が必要な場合

---

## 改訂履歴

| バージョン | 日付 | 変更内容 |
|------------|------|----------|
| 1.0 | 2025-12-19 | 初版作成 |
